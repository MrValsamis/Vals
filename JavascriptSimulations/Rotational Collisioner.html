<!doctype html>
<html>
    <head>
        <meta name="description" content="Simulation of conservation of angular momementum.">
        <title>RotationalCollisioner</title>
        <meta name="keywords" content="Angular, momentum, simulation, physics, HTML5">
        <meta name="author" content="Martin Kirby">
        <meta name="robots" content="index, follow">
        <meta name="revisit-after" content="1 month">
        <meta http-equiv="content-type" content="text/html; charset=utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    </head>

<script type="application/ld+json">
[ {"@context" : "http://schema.org", "@type" : "WebApplication", "url" : "kirbyx.com", "author" : { "@type" : "Person", "name" : "Martin Kirby"},"browserRequirements" : "requires HTML5 support","applicationCategory" : "simulation","applicationSubCategory" : "physics waves","fileSize" : "82KB","screenshot" : "https://sites.google.com/a/v3x.com/waveadd/_/rsrc/1526601040514/home/Picture4.png"}, {"@context" : "http://schema.org","@type" : "SoftwareApplication","author" : {"@type" : "Person","name" : "Martin Kirby" }} ]
</script>

<body>
<html>

<div.class=theWholeThing>

  <canvas id="canvas1"
    style="z-index: 1;
    position:relative;
    touch-action: auto;
    left:0px; top:0px;">
  </canvas>

  <canvas id="canvas2"
    style="z-index: 2;
    position:absolute;
    touch-action: auto;
    left:0px; top:0px;">
  </canvas>

  <canvas id="canvas3"
    style="z-index: 3;
    position:absolute;
    touch-action: auto;
    left:0px; top:0px;">
  </canvas>

  <canvas id="canvas4"
    style="z-index: 4;
    position:absolute;
    touch-action: auto;
    left:0px; top:0px;">
  </canvas>

  <canvas id="canvasInfo"
    style="z-index: -5;
    position:absolute;
    touch-action: auto;">
  </canvas>

  <div class="notthegraph">
      <section class="mslider">
          <div class="box1a" >
              <input type="range" min="-2" max="2" step="0.01" value="-1.0"  class="redslider" id="v1Range">        &nbsp;&nbsp;<span id="v1SliderValue">        </span> rad/s<br>
              <input type="range" min= "0" max="5" step="0.01" value="2.5"   class="redslider" id="mass1Range">     &nbsp;&nbsp;<span id="mass1SliderValue">     </span> kg<br>
              <input type="range" min= "0" max="3" step="0.01" value="1.5"   class="redslider" id="length1Range">   &nbsp;&nbsp;<span id="length1SliderValue">   </span> m<br>
              <input type="range" min= "0" max="3" step="0.01" value="2.0"   class="redslider" id="outRadius1Range">&nbsp;&nbsp;<span id="outRadius1SliderValue"></span> m<br>
              <input type="range" min= "0" max="3" step="0.01" value="0.6"   class="redslider" id="inRadius1Range"> &nbsp;&nbsp;<span id="inRadius1SliderValue"> </span> m<br>
              <input type="range" min= "0" max="2" step="0.01" value="0.132" class="redslider" id="density1Range">  &nbsp;&nbsp;<span id="density1SliderValue">  </span> kg/m³<br>
        </div>

        <div class="box1c" id="valueabbrev">
          <pre>
            ANGULAR VELOCITY
            MASS
            LENGTH
            OUTER RADIUS

            DENSITY
          </pre>
        </div>

        <div class="box1aa">
            <bdo dir="ltr"><span id="v2SliderValue">rad/s      </span> rad/s&nbsp;&nbsp;                              <input type="range" min="-2" max="2" step="0.01" value="0.5" class="DarkBlueslider" id="v2Range"></bdo><br>
            <bdo dir="ltr"><span id="mass2SliderValue">kg      </span> kg   &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      <input type="range" min="0"  max="5" step="0.01" value="2.0" class="DarkBlueslider" id="mass2Range"></bdo><br>
            <bdo dir="ltr"><span id="length2SliderValue">m     </span> m    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<input type="range" min="0"  max="3" step="0.01" value="2.0" class="DarkBlueslider" id="length2Range"></bdo><br>
            <bdo dir="ltr"><span id="outRadius2SliderValue">m  </span> m    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<input type="range" min="0"  max="3" step="0.01" value="1.5" class="DarkBlueslider" id="outRadius2Range"></bdo><br>
            <bdo dir="ltr"><span id="inRadius2SliderValue">m   </span> m    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<input type="range" min="0"  max="3" step="0.01" value="0.5" class="DarkBlueslider" id="inRadius2Range"></bdo><br>
            <bdo dir="ltr"><span id="density2SliderValue">kg/m³</span> kg/m³&nbsp;                                    <input type="range" min="0"  max="2" step="0.01" value="0.141" class="DarkBlueslider" id="density2Range"></bdo><br>
            <bdo dir="ltr"></bdo>
        </div>

    </section>

    <section class="buttonsnstuff">

        <div class="box3">
            <div class="topThreeBigButtons">
                <div class="switch-field1">
                    <input type="radio" id="hoop1"     name="switch_3"     onclick="getbuttonID()" />
                    <label for="hoop1"    > SOLID TUBE     </label><br>
                    <input type="radio" id="cylinder1" name="switch_3"     onclick="getbuttonID()" checked/>
                    <label for="cylinder1"> SOLID CYLINDER </label><br>
                    <input type="radio" id="box1"      name="switch_3"     onclick="getbuttonID()" />
                    <label for="box1"    > SOLID BOX       </label>
                </div>
            </div>
            <div class="box1aextra" >
              <input type="range" min="0" max="1.00" step="0.01" value="1.0" class="extraslider" id="computerRange">&nbsp;&nbsp;<span id="computerSliderValue"></span> <br>
            </div>
        </div>

        <div class="buttonBoxL">
            <div class="topThreeBigButtons">
                <div class="switch-field2">
                  <button type="button" id="collideButton"><b>COLLIDE            </b></button>
                  <button type="button" id="mathButton"   ><b>&nbsp;MATH ON&nbsp;</b></button>
                  <button type="button" id="askButton"    ><b>?                  </b></button>
                </div>
            </div>
       </div>

      <div class="box3">
            <div class="topThreeBigButtons">
              <div class="switch-field3">
                <input type="radio" id="hoop2"     name="switch_7"     onclick="getbuttonID()" />
                <label for="hoop2"    > SOLID TUBE     </label><br>
                <input type="radio" id="cylinder2" name="switch_7"     onclick="getbuttonID()" checked/>
                <label for="cylinder2"> SOLID CYLINDER </label><br>
                <input type="radio" id="box2"      name="switch_7"     onclick="getbuttonID()" />
                <label for="box2"      > SOLID BOX      </label>
              </div>
          </div>
          <div class="box1aaextra" >
              <bdo dir="ltr"><span id="persSliderValue"></span> <input type="range"          min="0"  max="0.5" step="0.01" value="0.3" class="extraslider" id="persRange"></bdo><br>
          </div>
        </div>

    </section>
 </div>
</div>
</body>


<style>

html{font-family:sans-serif}

input:disabled {
  background: #dddddd;
}

button {
     display: inline-block;
     background-color: green;
     border-radius: 10px;
     border: 4px double #cccccc;
     color: white;
     text-align: center;
     font-size: 18px;
     padding: 10px;
     width: 50%%;
     -webkit-transition: all 0.5s;
     -moz-transition: all 0.5s;
     -o-transition: all 0.5s;
     transition: all 0.5s;
     cursor: pointer;
     margin: 5px;
   }

body{
    -moz-user-select:-moz-none;
    -moz-user-select:none;
    -webkit-user-select:none;
    -ms-user-select:none;
    user-select:none;
    -webkit-user-drag:none;
    -webkit-touch-callout:none;

    margin:0;
    -webkit-tap-highlight-color:rgba(0,0,0,0);
    color:#333;
    padding-top:0;
    padding-bottom:0;
    padding-left:0%;
    padding-right:0%;
    touch-action:auto;
    font-family:sans-serif;
    background-color:white;
    font-size:10px
    }

  div.box1a{
    border:0 solid yellow;
    -webkit-tap-highlight-color:rgba(0,0,0,0);
    min-width:35%;
    font-weight:700;
    touch-action:auto;
    color:darkred;
    padding-left:2%;
    justify-content:space-around;
    direction:ltr
    }

  div.box1aextra{
    border:0 solid yellow;
    -webkit-tap-highlight-color:rgba(0,0,0,0);
    min-width:35%;
    font-weight:700;
    font-size:15px;
    touch-action:auto;
    color:black;
    padding-left:0%;
    padding-top: 40px;
    justify-content:left;
    direction:ltr
    }

  div.box1aaextra{
    border:0 solid yellow;
    -webkit-tap-highlight-color:rgba(0,0,0,0);
    min-width:35%;
    font-weight:700;
    font-size:15px;
    touch-action:auto;
    color:black;
    padding-left:0%;
    padding-top: 10px;
    justify-content:right;
    direction:rtl;
    }

  div.box1aa{
    border:0 solid Orange;
    -webkit-tap-highlight-color:rgba(0,0,0,0);
    min-width:35%;
    touch-action:auto;
    font-weight:700;
    color:darkDarkBlue;
    padding-right:2%;
    justify-content:space-around;
    direction:rtl
    }

  div.box1c{
    border:0 solid red;
    -webkit-tap-highlight-color:rgba(0,0,0,0);
    padding-top:0px;
    font-size:18px;touch-action:auto;
    max-width:30%;
    font-weight:800;
    text-align:center;
    justify-content:space-around;
    line-height:29px;
    }

  div.box3{
    border:0 solid lightgray;
    -webkit-tap-highlight-color:rgba(0,0,0,0);
    text-align:center;
    touch-action:auto;
    padding-right:1px;
    padding-left:1px;
    padding-top: 10px;
    justify-content:space-between;
    min-width:33%
    }

  section.mslider{
    touch-action:auto;
    display:flex;
    -webkit-tap-highlight-color:rgba(0,0,0,0);
    justify-content:space-between;
    border:0 solid purple
    }

  section.buttonsnstuff{
    touch-action:auto;
    display:flex;
    box-sizing:border-box;
    -webkit-tap-highlight-color:rgba(0,0,0,0);
    justify-content:space-around;
    border:0 solid red
    }

  div.topThreeBigButtons{
    touch-action:auto;
    margin:1px;
    border:0px solid lightgray;
    -webkit-tap-highlight-color:rgba(0,0,0,0);
    justify-content:space-between;
    min-width:33%;
    line-height:3.5vh
    }

  input[type=range].redslider{
    -webkit-appearance:none;
    width:70%;
    margin:5px 0;
    opacity: 0.7; /* Set transparency (for mouse-over effects on hover) */
    -webkit-transition: .1s; /* 0.2 seconds transition on hover */
    transition: opacity .2s;
    }

  input[type=range].redslider:hover {
    opacity: 1; /* Fully shown on mouse-over */
    }

  input[type=range].redslider::-webkit-slider-runnable-track{
    width:100%;
    height:15px;
    cursor:pointer;
    box-shadow:.2px .2px 2px #000000,0 0 .5px #0d0d0d;
    background:rgba(152,152,152,.09);
    border-radius:5px;
    border:0 solid #000
    }

  input[type=range].redslider::-ms-tooltip{
    display:none
    }

  input[type=range].redslider::-webkit-slider-thumb{
    box-shadow:1px 1px 1px #000000,0 0 1px #0d0d0d;
    border:0 solid #000;
    height:15px;
    width:25px;
    border-radius:7.7px;
    background:red;
    cursor:pointer;
    -webkit-appearance:none;
    margin-top:0
    }

  input[type=range].redslider:focus::-webkit-slider-runnable-track{
    background:rgba(165,165,165,.09)
    }

  input[type=range].redslider::-moz-range-track{
    width:100%;
    height:15px;
    cursor:pointer;
    box-shadow:.5px .5px 6px #000000,0 0 .5px #0d0d0d;
    background:rgba(152,152,152,.09);
    border-radius:11.8px;
    border:0 solid #000
    }

  input[type=range].redslider::-moz-range-thumb{
    box-shadow:1px 1px 1px #000000,0 0 1px #0d0d0d;
    border:1px solid #000;
    height:15px;
    width:30px;
    border-radius:50px;
    background:rgba(255,106,107,.75);
    cursor:pointer
    }

  input[type=range].redslider::-ms-track{
    width:95%;
    height:15px;
    cursor:pointer;
    background:transparent;
    border-color:transparent;
    color:transparent
    }

  input[type=range].redslider::-ms-tooltip{
    display:none
    }

  input[type=range].redslider::-ms-fill-lower{
    background:rgba(139,139,139,.09);
    border:0 solid #000;
    border-radius:0;
    box-shadow:.5px .5px 6px #000000,0 0 .5px #0d0d0d
    }

  input[type=range].redslider::-ms-fill-upper{
    background:rgba(152,152,152,.09);
    border:0 solid #000;
    border-radius:0;
    box-shadow:.5px .5px 6px #000000,0 0 .5px #0d0d0d
    }

  input[type=range].redslider::-ms-thumb{
    box-shadow:1px 1px 1px #000000,0 0 1px #0d0d0d;
    border:0 solid #000;
    width:30px;
    background:rgba(255,106,107,1);
    cursor:pointer;
    height:15px
    }

  input[type=range].redslider:focus::-ms-fill-lower{
    background:rgba(152,152,152,.09)
    }

  input[type=range].redslider:focus::-ms-fill-upper{
    background:rgba(165,165,165,.09)
    }

  input:disabled {
    background: #dddddd;
  }

  .extraslider {
    -webkit-appearance: none;
    appearance: none;
    width: 30%;
    height: 8px;
    background: #d3d3d3;
    outline: none;
    opacity: 0.7;
    -webkit-transition: .1s;
    transition: opacity .2s;
  }

  .extraslider:hover {
    opacity: 1;
  }

  .extraslider::-webkit-slider-thumb {
    -webkit-appearance: none;
    appearance: none;
    width: 16px;
    height: 16px;
    border-radius: 8px;
    background: blue;
    cursor: pointer;
  }

  .extraslider::-moz-range-thumb {
    width: 15px;
    height: 15px;
    background: #4CAF50;
    cursor: pointer;
  }

  input[type=range].DarkBlueslider{
    -webkit-appearance:none;
    width:70%;
    margin:5px 0;
    direction:ltr;
    opacity: 0.7;
    -webkit-transition: .1s;
    transition: opacity .2s;
    }

  input[type=range].DarkBlueslider:hover {
    opacity: 1;
  }

  input[type=range].DarkBlueslider::-webkit-slider-runnable-track{
    width:100%;
    height:15px;
    cursor:pointer;
    box-shadow:.2px .2px 2px #000000,0 0 .5px #0d0d0d;
    background:rgba(152,152,152,.09);
    border-radius:5px;
    border:0 solid #000
    }

  input[type=range].DarkBlueslider::-ms-tooltip{
    display:none
    }

  input[type=range].DarkBlueslider::-webkit-slider-thumb{
    box-shadow:1px 1px 1px #000000,0 0 1px #0d0d0d;
    border:0 solid #000;
    height:15px;
    width:25px;
    border-radius:7.7px;
    background:DarkBlue;
    cursor:pointer;
    -webkit-appearance:none;
    margin-top:0
    }

  input[type=range].DarkBlueslider:focus::-webkit-slider-runnable-track{
    background:rgba(165,165,165,.09)
    }

  input[type=range].DarkBlueslider::-moz-range-track{
    width:100%;
    height:15px;
    direction:ltr;
    cursor:pointer;
    box-shadow:.5px .5px 6px #000000,0 0 .5px #0d0d0d;
    background:rgba(152,152,152,.09);
    border-radius:11.8px;
    border:0 solid #000
    }

  input[type=range].DarkBlueslider::-moz-range-thumb{
    box-shadow:1px 1px 1px #000000,0 0 1px #0d0d0d;
    border:0 solid #000;
    height:15px;
    width:30px;
    border-radius:50px;
    background:rgba(0,134,255,.75);
    cursor:pointer
    }

  input[type=range].DarkBlueslider::-ms-track{
    width:95%;
    height:15px;
    direction:ltr;
    cursor:pointer;
    background:transparent;
    border-color:transparent;
    color:transparent
    }

  input[type=range].DarkBlueslider::-ms-fill-lower{
    background:rgba(139,139,139,.09);
    border:0 solid #000;
    border-radius:0;
    box-shadow:.5px .5px 6px #000000,0 0 .5px #0d0d0d
    }

  input[type=range].DarkBlueslider::-ms-fill-upper{
    background:rgba(152,152,152,.09);
    border:0 solid #000;
    border-radius:0;
    box-shadow:.5px .5px 6px #000000,0 0 .5px #0d0d0d
    }

  input[type=range].DarkBlueslider::-ms-thumb{
    box-shadow:1px 1px 1px #000000,0 0 1px #0d0d0d;
    border:0 solid #000;
    width:30px;
    background:rgba(0,134,255,1);
    cursor:pointer;
    height:15px
    }

  input[type=range].DarkBlueslider:focus::-ms-fill-lower{
    background:rgba(152,152,152,.09)
    }

  input[type=range].DarkBlueslider:focus::-ms-fill-upper{
    background:rgba(165,165,165,.09)
    }

  input:disabled {
      background: #dddddd;
    }

  .switch-field1 input{
    position:absolute!important;
    clip:rect(0,0,0,0);
    height:1px;
    width:1px;
    border:0;
    overflow:hidden}
  .switch-field1 label{
    float:left}
  .switch-field1 label{
    display:inline-block;
    width:100%;
    background-color:#FFF0F5;
    color:rgba(0,0,0,1);
    font-size:11px;
    text-align:center;
    border:1px solid rgba(0,0,0,.2)}
  .switch-field1 input:checked + label{
    color:#fff;
    font-weight:700;
    font-size:12px;
    background-color:#f33}
  .switch-field1 input:disabled + label{
    color:#fff;
    font-weight:700;
    font-size:12px;
    background-color: #FFF0F5}


  .switch-field3{
    font-family:"sans-serif",Tahoma,Verdana,Lucida;overflow:hidden}
  .switch-title3{
    margin-bottom:3px;margin-left:1px}
  .switch-field3 input{
    position:absolute!important;
    clip:rect(0,0,0,0);
    height:1px;
    width:1px;
    border:0;overflow:hidden}
  .switch-field3 label{
    float:left}
  .switch-field3 label{
    display:inline-block;
    width:100%;
    background-color:#E0FFFF;
    color:rgba(0,0,0,1);
    font-size:11px;
    text-align:center;
    border:1px solid rgba(0,0,0,.2)}
  .switch-field3 input:checked + label{
    color:#fff;
    font-weight:700;
    font-size:12px;
    background-color:#33f}
  .switch-field3 input:disabled + label{
    color:#fff;
    font-weight:700;
    font-size:12px;
    background-color: #E0FFFF;}

  #canvas1{
    width:100%;
    position:absolute;
    touch-action:auto;
    height:55vh;
    background-color: transparent}

  #canvas2{
    width:100%;
    position:relative;
    touch-action:auto;
    height:55vh;
    background-color:transparent;
    opacity:1}

  #canvas3{
    width:100%;
    position:relative;
    touch-action:auto;
    height:55vh;
    background-color:transparent;
    opacity:1}

  #canvas4{
    width:100%;
    position:relative;
    touch-action:auto;
    height:55vh;
    background-color:transparent;
    opacity:1}

  #canvasInfo{
    padding: 0;
    margin: auto;
    display: block;
    width:80%;
    position: absolute;
    top: 0;
    bottom: 0;
    left: 0;
    right: 0;
    position:relative;
    touch-action:auto;
    background-color:white;
    opacity:1}

  </style>

<script type="text/javascript">

var density1 = 0.133;
var density2 = 0.141;
var v1 = -1;
var v2 = 0.5;
var v3 = 0;
var oldv1 =2;
var oldv2 =-1;
var storedv1 = 0;
var storedv2 = 0;
var v1box = 2;
var v2box = 2;
var v3box = 2;
var oldv1box =2;
var oldv2box =2;
var vconstant = 0.5122;
v1box = v1 * vconstant;
v2box = v2 * vconstant;
storedv1 = v1;
storedv2 = v2;
storedv1box = v1box;
storedv2box = v2box;
storecount = false;
var beforecollisionv1 = 0;
var beforecollisionv2 = 0;

var mass1 = 2.5;
var mass2 = 2.0;
var length1 = 1.5;
var boxlength1 = 0
var boxlength2 = 0;
var length2 = 2.0;
var outradius1 = 2.0;
var outradius2 = 1.5;
var inradius1 = 0.6;
var inradius2 = 0.5;
var width1 = 2.0;
var width2 = 2.0;
var height1 = 0.5;
var height2 = 0.5;
var boxradius1 = 0;
var boxradius2 = 0;

var shape1 = 3;
var shape2 = 3;

var volume1 = 0;
var volume2 = 0;

var oldXX1 = 0;
var oldXX2 = 0;

var lineX1begin = 0;
var lineX1end = 0;
var lineY1 = 0;
var oldlineX1begin = 0;
var oldlineX1end = 0;
var oldlineY1 = 0;
var oldlineX1begin = 0;
var oldlineX1end = 0;
var oldlineY1 = 0;

var lineX2begin = 0;
var lineX2end = 0;
var lineY2 = 0;
var lineY2 = 0;
var turnIncrement1 = 0.0;
var turnIncrement2 = 0.0;

var incCounter1 = 0;
var incCounter2 = 0;
var incCounterbox1 = 0;
var incCounterbox2 = 0;
var click1 = 0.0;
var click2 = 0.0;
var passCount1 = 0;
var passCount2 = 0;
var tt = false;

var persangle = 0.3;
var compspeed = 1.00;

var aspectconstant = 0;
var oldcanvas1width = 0;

var collidenow = false;
var themathbutton = false;
var askButton = false;
var thecoordinatebutton = false;

var testxvalue = false;

var angI1 = 0.0;
var angI2 = 0.0;
var finalangv = 0.0;
var angL1 = 0.0;
var angL2 = 0.0;
var angL1after = 0;
var angL2after = 0;
var totalL = 0.0;
var totalangL2 = 0.0;
var totalI = 0.0;

var textchangepasscount = 0;

var AAX1begin = 0;
var AAY1begin = 0;
var AAX1end   = 0;
var AAY1end   = 0;
//_________________
var AAX2begin = 0;
var AAY2begin = 0;
var AAX2end   = 0;
var AAY2end   = 0;
//_________________
var AAX3begin = 0;
var AAY3begin = 0;
var AAX3end   = 0;
var AAY3end   = 0;
//_________________
var AAX4begin = 0;
var AAY4begin = 0;
var AAX4end   = 0;
var AAY4end   = 0;
//________________
var AAX5begin = 0;
var AAY5begin = 0;
var AAX5end   = 0;
var AAY5end   = 0;

var BAX1begin = 0;
var BAY1begin = 0;
var BAX1end   = 0;
var BAY1end   = 0;
//_________________
var BAX2begin = 0;
var BAY2begin = 0;
var BAX2end   = 0;
var BAY2end   = 0;
//_________________
var BAX3begin = 0;
var BAY3begin = 0;
var BAX3end   = 0;
var BAY3end   = 0;
//_________________
var BAX4begin = 0;
var BAY4begin = 0;
var BAX4end   = 0;
var BAY4end   = 0;
//________________
var BAX5begin = 0;
var BAY5begin = 0;
var BAX5end   = 0;
var BAY5end   = 0;

var color1 = 'x';
var firstnum1 = 100;
var secnum1   = 200;
var thirdnum1 = 200;
var firstnumstring1 = '';
var secnumstring1   = '';
var thirdnumstring1 = '';

var color2 = 'x';
var firstnum2 = 100;
var secnum2   = 200;
var thirdnum2 = 200;
var firstnumstring2 = '';
var secnumstring2   = '';
var thirdnumstring2 = '';

var commastring = ',';
var parenstring = ',';
var rgbstring = 'rgb(';

//______________________________________________________________________
function calculateDensity(){
    if (shape1 == 2){volume1 =   Math.PI*outradius1*outradius1*Number(length1slider.value).valueOf()};
    if (shape1 == 1){volume1 = ((Math.PI*outradius1*outradius1)-(Math.PI*inradius1*inradius1))*(length1slider.value)};
    if (shape1 == 3){volume1 =   8*width1*height1*Number(length1slider.value).valueOf()};
    if (shape2 == 2){volume2 =   Math.PI*outradius2*outradius2*Number(length2slider.value).valueOf()};
    if (shape2 == 1){volume2 = ((Math.PI*outradius2*outradius2)-(Math.PI*inradius2*inradius2))*(length2slider.value)};
    if (shape2 == 3){volume2 =   8*width2*height2*Number(length2slider.value).valueOf()};
    density1 = mass1 / volume1;
    density2 = (mass2) / (volume2);

    document.getElementById("density1Range").value = density1;
    density1text.innerHTML = density1.toFixed(2);
    document.getElementById("density2Range").value = density2;
    density2text.innerHTML = density2.toFixed(2);
    densityshade1();
    densityshade2();
}
//______________________________________________________________________
function collidethem(){
   collidenow = !collidenow;
      if(collidenow == false){
          document.getElementById('collideButton').style.color = 'white';
          document.querySelector('#collideButton').innerHTML = '<b>COLLIDE<b>';
      }
      if(collidenow == true){
          document.getElementById('collideButton').style.color = 'yellow';
          document.querySelector('#collideButton').innerHTML = '<b>&nbsp;&nbsp;RESET&nbsp;&nbsp;<b>';
      }
 }
//______________________________________________________________________
 function showmath(){
    themathbutton = !themathbutton;
       if(themathbutton == false){
           document.getElementById('mathButton').style.color = 'white';
           document.querySelector('#mathButton').innerHTML = '<b>&nbsp;MATH ON&nbsp;<b>';
       }
       if(themathbutton == true){
           document.getElementById('mathButton').style.color = 'yellow';
           document.querySelector('#mathButton').innerHTML = '<b>MATH OFF<b>';
       }
 }
//______________________________________________________________________
 function questionmark(){
    askButton = !askButton;
       if(askButton == false){
          document.getElementById('askButton').style.color = 'white';
       }
       if(askButton == true){
           document.getElementById('askButton').style.color = 'yellow';
           InfoBox();
       }
 }
//______________________________________________________________________
 function InfoBox(){
     document.getElementById("canvasInfo").style.zIndex = 20;
     canvasInfo.width=2000;
     canvasInfo.height=1000;

     ctxInfo.linewidth = 8;
     ctxInfo.beginPath();
     ctxInfo.moveTo(0,0);
     ctxInfo.lineTo(2000,0);
     ctxInfo.lineTo(2000,1000);
     ctxInfo.lineTo(0,1000);
     ctxInfo.lineTo(0,0);
     ctxInfo.stroke();

     ctxInfo.font = "lighter 40px Arial";
     ctxInfo.lineWidth= 6;
     ctxInfo.strokeStyle = "black";
     ctxInfo.font = "bold 60px Arial";
     ctxInfo.beginPath();
     ctxInfo.fillText("RotationalCollisioner... ",                                                                      (0.09*canvasInfo.width),(0.16*canvasInfo.height))
     ctxInfo.fill();
     ctxInfo.closePath();
     ctxInfo.fillStyle = "red";
     ctxInfo.fillText("Demonstrates the law of conservation of angular momentum.",                                       (0.09*canvasInfo.width),(0.25*canvasInfo.height))
     ctxInfo.fill();
     ctxInfo.closePath();
     ctxInfo.beginPath();
     ctxInfo.fillStyle = "black";
     ctxInfo.fill();
     ctxInfo.stroke();
     ctxInfo.beginPath();
     ctxInfo.font = "lighter 60px Arial";
     ctxInfo.fillText("Rotating masses collide, and become stuck together...",                                           (0.09*canvasInfo.width),(0.35*canvasInfo.height))

     ctxInfo.font = " lighter 40px Arial";

     ctxInfo.fillText("Changes in motion due to conservation of linear momentum are ignored in this simulation.",         (0.09*canvasInfo.width),(0.45*canvasInfo.height))
     ctxInfo.fillText("All masses in this simulation have uniform density.",                                              (0.09*canvasInfo.width),(0.50*canvasInfo.height))
     ctxInfo.fillText("The greater the density, the darker the shading.",                                                                 (0.09*canvasInfo.width),(0.55*canvasInfo.height))

     ctxInfo.fillText("All collisions are inelastic except when both both masses have the same initial angular velocity.",(0.09*canvasInfo.width),(0.60*canvasInfo.height))
     ctxInfo.fillText("     represents a center of mass.",                                                                (0.09*canvasInfo.width),(0.65*canvasInfo.height))

     ctxInfo.beginPath();
     ctxInfo.lineWidth = 4;
     ctxInfo.fillStyle = 'green';
     ctxInfo.ellipse(0.097*canvasInfo.width, 0.645*canvasInfo.height, 10, 10, 0, 0, 2 * Math.PI);
     ctxInfo.fill();
     ctxInfo.closePath();

     ctxInfo.beginPath();
     ctxInfo.fillStyle = "brown";
     ctxInfo.fillText("This simulation is free for anyone to use, as long as it's unchanged.",                             (0.22*canvasInfo.width),(0.73*canvasInfo.height))
     ctxInfo.fillText("To comment, send an email to waveaddapp@gmail.com.",                                                (0.22*canvasInfo.width),(0.80*canvasInfo.height))
     ctxInfo.fillText("To download this simulation go to kirbyx.com.",                                                     (0.22*canvasInfo.width),(0.87*canvasInfo.height))
     ctxInfo.fill();
     ctxInfo.font = "lighter 30px Arial";
     ctxInfo.fillText("Copyright 2021 Martin Kirby. All rights reserved.",                                                 (0.6*canvasInfo.width),(0.94*canvasInfo.height))
     ctxInfo.stroke;
     ctxInfo.fill();
     ctxInfo.closePath();

     ctxInfo.beginPath();
     ctxInfo.lineWidth= 6;
     ctxInfo.strokeStyle = "black";
     ctxInfo.fillStyle = 'green';
     ctxInfo.rect(0.85*canvasInfo.width, 0.75*canvasInfo.height,0.1*canvasInfo.width, 0.1*canvasInfo.height);
     ctxInfo.stroke();
     ctxInfo.fill();
     ctxInfo.beginPath();
     ctxInfo.fillStyle = 'white';
     ctxInfo.font = "bold 40px Arial";
     ctxInfo.fillText("CLOSE",(0.865*canvasInfo.width),(0.813*canvasInfo.height))
     ctxInfo.font = "lighter 40px Arial";
     ctxInfo.stroke();
     ctxInfo.fill();
  }
//______________________________________________________________________
function InfoBoxErase(){
    if(askButton == false){
        document.getElementById('askButton').style.color = 'white';
    }
    if(askButton == true){
        document.getElementById('askButton').style.color = 'yellow';
    }

    document.getElementById("canvasInfo").style.zIndex = -5;
    canvasInfo.width=2000;
    canvasInfo.height=1000;
    ctxInfo.lineWidth= 6;
    ctxInfo.strokeStyle = "white";
    ctxInfo.beginPath();
    ctxInfo.rect(0, 0, canvasInfo.width, canvasInfo.height);
    ctxInfo.stroke();
    ctxInfo.font = " lighter 40px Arial";
    ctxInfo.fillStyle = 'white';
}
//______________________________________________________________________
 function htmltextchange(){
   textchangepasscount = textchangepasscount +1;
       if(textchangepasscount>1){
           if(shape1 == 1){
               outRadius1text.innerHTML = Number(1 * outRadius1slider.value).valueOf().toFixed(2);
                inRadius1text.innerHTML = Number(1 *  inRadius1slider.value).valueOf().toFixed(2);
                  length1text.innerHTML = Number(1 *    length1slider.value).valueOf().toFixed(2);
             }
           if(shape1 == 2){
               outRadius1text.innerHTML = Number(1 * outRadius1slider.value).valueOf().toFixed(2);
                inRadius1text.innerHTML = " ";
                  length1text.innerHTML = Number(1 *    length1slider.value).valueOf().toFixed(2);
             }
           if(shape1 == 3){
               outRadius1text.innerHTML = Number(2 * outRadius1slider.value).valueOf().toFixed(2);
                inRadius1text.innerHTML = Number(2 *  inRadius1slider.value).valueOf().toFixed(2);
                  length1text.innerHTML = Number(2 *    length1slider.value).valueOf().toFixed(2);
             }

           if(shape2 == 1){
               outRadius2text.innerHTML = Number(1 * outRadius2slider.value).valueOf().toFixed(2);
                inRadius2text.innerHTML = Number(1 *  inRadius2slider.value).valueOf().toFixed(2);
                  length2text.innerHTML = Number(1 *    length2slider.value).valueOf().toFixed(2);
             }
           if(shape2 == 2){
               outRadius2text.innerHTML = Number(1 * outRadius2slider.value).valueOf().toFixed(2);
                inRadius2text.innerHTML = " ";
                  length2text.innerHTML = Number(1 *    length2slider.value).valueOf().toFixed(2);
             }
           if(shape2 == 3){
               outRadius2text.innerHTML = Number(2 * outRadius2slider.value).valueOf().toFixed(2);
                inRadius2text.innerHTML = Number(2 *  inRadius2slider.value).valueOf().toFixed(2);
                  length2text.innerHTML = Number(2 *    length2slider.value).valueOf().toFixed(2);
             }
        }
    }
//______________________________________
function densityshade1(){
  firstnum1 = parseInt(255 -(density1*10));
  secnum1   = parseInt(255 -(density1*100));
  thirdnum1 = parseInt(255 -(density1*100));
  firstnumstring1 = firstnum1.toString();
  secnumstring1   =   secnum1.toString();
  thirdnumstring1 = thirdnum1.toString();
  color1 = rgbstring.concat(firstnumstring1,',',secnumstring1,',',thirdnumstring1,')');
}
//______________________________________
function densityshade2(){

  firstnum2 = parseInt(255 -(density2*100));
  secnum2   = parseInt(255 -(density2*10));
  thirdnum2 = parseInt(255 -(density2*10));

  firstnumstring2 = firstnum2.toString();
  secnumstring2   =   secnum2.toString();
  thirdnumstring2 = thirdnum2.toString();
  color2 = rgbstring.concat(firstnumstring2,',',secnumstring2,',',thirdnumstring2,')');
}
//______________________________________________________________________
function getbuttonID() {
    if (document.getElementById("hoop1").checked){
          shape1=1;
          if (inradius1>outradius1){
                inradius1 = outradius1;
                inRadius1slider.value   = outRadius1slider.value;
                inRadius1text.innerHTML = outRadius1text.innerHTML;
                }
              }
    if (document.getElementById("cylinder1").checked){
        shape1=2;
      }
    if (document.getElementById("box1").checked){
        shape1=3;
      }
    if (document.getElementById("hoop2").checked){
       shape2=1;
          if (inradius2>outradius2){
                inradius2 = outradius2;
                inRadius2slider.value   = outRadius2slider.value;
                inRadius2text.innerHTML = outRadius2text.innerHTML;
                }
              }
    if (document.getElementById("cylinder2").checked){shape2=2;}
    if (document.getElementById("box2").checked)     {shape2=3;}
}
//______________________________________________________________________
function testx(){
  testxvalue = !testxvalue;
}
//______________________________________________________________________
function testxreset(){
  testxvalue = false;
}
//______________________________________________________________________
function checkFontSizer(){
    if (canvas1.width<=900){
        document.getElementById("v1SliderValue").style.fontSize= "9px";
        document.getElementById("mass1SliderValue").style.fontSize= "9px";
        document.getElementById("density1SliderValue").style.fontSize= "9px";
        document.getElementById("length1SliderValue").style.fontSize= "9px";
        document.getElementById("outRadius1SliderValue").style.fontSize= "9px";
        document.getElementById("inRadius1SliderValue").style.fontSize= "9px";
        document.getElementById("v2SliderValue").style.fontSize= "9px";
        document.getElementById("mass2SliderValue").style.fontSize= "9px";
        document.getElementById("density2SliderValue").style.fontSize= "9px";
        document.getElementById("length2SliderValue").style.fontSize= "9px";
        document.getElementById("outRadius2SliderValue").style.fontSize= "9px";
        document.getElementById("inRadius2SliderValue").style.fontSize= "9px";
        document.getElementById("persSliderValue").style.fontSize= "8px";
        document.getElementById("computerSliderValue").style.fontSize= "8px";
        document.getElementById("valueabbrev"  ).style.fontSize= "8px";
        document.getElementById("valueabbrev").style.lineHeight = "25px";
        }
        else if (canvas1.width<=1200){
            document.getElementById("v1SliderValue").style.fontSize= "15px";
            document.getElementById("mass1SliderValue").style.fontSize= "15px";
            document.getElementById("density1SliderValue").style.fontSize= "15px";
            document.getElementById("length1SliderValue").style.fontSize= "15px";
            document.getElementById("outRadius1SliderValue").style.fontSize= "15px";
            document.getElementById("inRadius1SliderValue").style.fontSize= "15px";
            document.getElementById("v2SliderValue").style.fontSize= "15px";
            document.getElementById("mass2SliderValue").style.fontSize= "15px";
            document.getElementById("density2SliderValue").style.fontSize= "15px";
            document.getElementById("length2SliderValue").style.fontSize= "15px";
            document.getElementById("outRadius2SliderValue").style.fontSize= "15px";
            document.getElementById("inRadius2SliderValue").style.fontSize= "15px";
            document.getElementById("persSliderValue").style.fontSize= "9px";
            document.getElementById("computerSliderValue").style.fontSize= "9px";
            document.getElementById("valueabbrev"  ).style.fontSize= "12px";
            document.getElementById("valueabbrev").style.lineHeight = "25px";
          }
          else if (canvas1.width<=1400){
             document.getElementById("v1SliderValue").style.fontSize= "17px";
              document.getElementById("mass1SliderValue").style.fontSize= "17px";
              document.getElementById("density1SliderValue").style.fontSize= "17px";
              document.getElementById("length1SliderValue").style.fontSize= "17px";
              document.getElementById("outRadius1SliderValue").style.fontSize= "17px";
              document.getElementById("inRadius1SliderValue").style.fontSize= "17px";
              document.getElementById("v2SliderValue").style.fontSize= "17px";
              document.getElementById("mass2SliderValue").style.fontSize= "17px";
              document.getElementById("density2SliderValue").style.fontSize= "17px";
              document.getElementById("length2SliderValue").style.fontSize= "17px";
              document.getElementById("outRadius2SliderValue").style.fontSize= "17px";
              document.getElementById("inRadius2SliderValue").style.fontSize= "17px";
              document.getElementById("persSliderValue").style.fontSize= "12px";
              document.getElementById("computerSliderValue").style.fontSize= "12px";
              document.getElementById("valueabbrev"  ).style.fontSize= "17px";
              document.getElementById("valueabbrev").style.lineHeight = "25px";
            }
            else if (canvas1.width>1400){
                document.getElementById("v1SliderValue").style.fontSize= "25px";
                document.getElementById("mass1SliderValue").style.fontSize= "25px";
                document.getElementById("density1SliderValue").style.fontSize= "25px";
                document.getElementById("length1SliderValue").style.fontSize= "25px";
                document.getElementById("outRadius1SliderValue").style.fontSize= "25px";
                document.getElementById("inRadius1SliderValue").style.fontSize= "25px";
                document.getElementById("v2SliderValue").style.fontSize= "25px";
                document.getElementById("mass2SliderValue").style.fontSize= "25px";
                document.getElementById("density2SliderValue").style.fontSize= "25px";
                document.getElementById("length2SliderValue").style.fontSize= "25px";
                document.getElementById("outRadius2SliderValue").style.fontSize= "25px";
                document.getElementById("inRadius2SliderValue").style.fontSize= "25px";
                document.getElementById("persSliderValue").style.fontSize= "15px";
                document.getElementById("computerSliderValue").style.fontSize= "15px";
                document.getElementById("valueabbrev"  ).style.fontSize= "20px"
                document.getElementById("valueabbrev").style.lineHeight = "30px";;
              }
  }
//______________________________________________________________________
function onresizing(){
        checkFontSizer();
        draw();
}
//______________________________________________________________________
var developer = "Martin Kirby. waveaddapp@gmailcom";
var licence = "copyright 2021 Martin Kirby. All rights reserved." ;

var canvas1 =  document.getElementById('canvas1');
ctx = canvas1.getContext('2d');
var canvas2 =  document.getElementById('canvas2');
ctx2 = canvas2.getContext('2d');
var canvas3 =  document.getElementById('canvas3');
ctx3 = canvas3.getContext('2d');
var canvas4 =  document.getElementById('canvas4');
ctx4 = canvas4.getContext('2d');
var canvasInfo =  document.getElementById('canvasInfo');
ctxInfo = canvasInfo.getContext('2d');

getbuttonID();
checkFontSizer();

window.addEventListener('resize',onresizing());
document.getElementById("collideButton").onclick = collidethem;
document.getElementById("mathButton"  ).onclick  = showmath;
document.getElementById("askButton"  ).onclick  = questionmark;

//-------------------Angular velocity 1----------------------------------
var v1slider = document.getElementById("v1Range");
document.getElementById("v1Range").value = v1;
v1box=v1*vconstant;
storedv1box = v1box;
var v1text = document.getElementById("v1SliderValue");
v1text.innerHTML = (1*v1slider.value).toFixed(2);

v1slider.oninput = function() {
    v1text.innerHTML =(1*v1slider.value).toFixed(2);
    v1 = Number(v1slider.value).valueOf();
    v1box=v1*vconstant;
    storedv1box = v1box;
    storedv1 = v1;
 };

 //-------------------angular velocity 2----------------------------------
 var v2slider = document.getElementById("v2Range");
 document.getElementById("v2Range").value = v2;
 v2box=v2*vconstant;
 storedv2box = v2box;
 var v2text = document.getElementById("v2SliderValue");
 v2text.innerHTML = (1*v2slider.value).toFixed(2);

 v2slider.oninput = function() {
     v2text.innerHTML =(1*v2slider.value).toFixed(2);
     v2 = Number(v2slider.value).valueOf();
     v2box=v2*vconstant;
     storedv2box = v2box;
     storedv2 = v2;
};

//-------------------Mass 1----------------------------------
var mass1slider = document.getElementById("mass1Range");
document.getElementById("mass1Range").value = mass1;
var mass1text = document.getElementById("mass1SliderValue");
mass1text.innerHTML = (1*mass1slider.value).toFixed(2);
densityshade1();

mass1slider.oninput = function() {
  mass1text.innerHTML =(1*mass1slider.value).toFixed(2);
  mass1 = Number(mass1slider.value).valueOf();
  document.getElementById("density1Range").value = density1;

  calculateDensity();
  densityshade1();
  density1text.innerHTML = density1.toFixed(2);
};

//-------------------mass 2----------------------------------
var mass2slider = document.getElementById("mass2Range");
document.getElementById("mass2Range").value = mass2;;
var mass2text = document.getElementById("mass2SliderValue");
mass2text.innerHTML = (1*mass2slider.value).toFixed(2);
densityshade2();

mass2slider.oninput = function() {
    mass2text.innerHTML =(1*mass2slider.value).toFixed(2);
    mass2 = Number(mass2slider.value).valueOf();
    document.getElementById("density2Range").value = density2;
    density2text.innerHTML = density2.toFixed(2);
    calculateDensity();
    densityshade2();
    density1text.innerHTML = density1.toFixed(2);
};

// -------------------density 1-----------------------------------
var density1slider = document.getElementById("density1Range");
var density1text = document.getElementById("density1SliderValue");
density1text.innerHTML = (1*density1slider.value).toFixed(2);

density1slider.oninput = function() {
    density1 = Number(density1slider.value).valueOf();
    density1text.innerHTML =(1*density1slider.value).toFixed(2);
    document.getElementById("mass1Range").value = (density1*volume1);
    mass1 = (density1*volume1);
    densityshade1();
    mass1text.innerHTML = mass1.toFixed(2);
};

// -------------------density 2-----------------------------------
var density2slider = document.getElementById("density2Range");
var density2text = document.getElementById("density2SliderValue");
density2text.innerHTML = (1*density2slider.value).toFixed(2);

density2slider.oninput = function() {
  density2 = Number(density2slider.value).valueOf();
  density2text.innerHTML = (1*density2slider.value).toFixed(2);
  document.getElementById("mass2Range").value = (density2*volume2);
  mass2 = (density2*volume2);
  densityshade2();
  mass2text.innerHTML = mass2.toFixed(2);
};

// -------------------length 1------------------------------------
var length1slider = document.getElementById("length1Range");
var length1text = document.getElementById("length1SliderValue");
length1text.innerHTML = (1*length1slider.value).toFixed(2);

length1slider.oninput = function() {
    length1 = Number(length1slider.value).valueOf();
    length1 = Math.sin(persangle*Math.PI) * length1;
    length1text.innerHTML = (1*length1slider.value).toFixed(2);
    document.getElementById("density1Range").value = density1;
    density1text.innerHTML = density1.toFixed(2);
    calculateDensity();
    density1text.innerHTML = density1.toFixed(2);
};

// -------------------length 2--------------------------------------
var length2slider = document.getElementById("length2Range");
var length2text = document.getElementById("length2SliderValue");
length2text.innerHTML = (1*length2slider.value).toFixed(2);

length2slider.oninput = function() {
    length2 = Number(length2slider.value).valueOf();
    length2 = Math.sin(persangle*Math.PI) * length2;
    length2text.innerHTML = (1*length2slider.value).toFixed(2);
    document.getElementById("density2Range").value = density2;
    calculateDensity();
    density2text.innerHTML = density2.toFixed(2);
};

// -------------------outradius 1----------------------------------------
var outRadius1slider = document.getElementById("outRadius1Range");
var outRadius1text = document.getElementById("outRadius1SliderValue");
outRadius1text.innerHTML = (1*outRadius1slider.value).toFixed(2); // Display the default slider value

outRadius1slider.oninput = function() {
  if(shape1==2){
        outRadius1text.innerHTML = (1*outRadius1slider.value).toFixed(2);
        outradius1 = Number(outRadius1slider.value).valueOf();
      }
  if(shape1==1){
        if(outradius1>=inradius1){
          outRadius1text.innerHTML = (1*outRadius1slider.value).toFixed(2);
          outradius1 = Number(outRadius1slider.value).valueOf();
      }
        if(outradius1<inradius1){
          outRadius1text.innerHTML = inRadius1text.innerHTML;
          outradius1 = Number(inRadius1slider.value).valueOf();
          outRadius1slider.value=inRadius1slider.value;
      }
}
    if(shape1==3){
            outradius1 = Number(outRadius1slider.value).valueOf();
            boxradius1 = (Math.sqrt(inRadius1slider.value*inRadius1slider.value)+(outRadius1slider.value*outRadius1slider.value));
            outRadius1text.innerHTML = 2 * Number(outRadius1slider.value).valueOf().toFixed(2);
        }
    document.getElementById("density1Range").value = density1;
    calculateDensity();
    density1text.innerHTML = density1.toFixed(2);
};

// -------------------outradius 2----------------------------------------
  var outRadius2slider = document.getElementById("outRadius2Range");
  var outRadius2text = document.getElementById("outRadius2SliderValue");
  outRadius2text.innerHTML = (outRadius2slider.value*1).toFixed(2);
  outRadius2slider.oninput = function() {

    if(shape2==1){
            if(outradius2>=inradius2){
              outRadius2text.innerHTML = (1*outRadius2slider.value).toFixed(2);
              outradius2 = Number(outRadius2slider.value).valueOf();
              }
            if(outradius2<inradius2){
              outRadius2text.innerHTML = inRadius2text.innerHTML;
              outradius2 = Number(1*inRadius2slider.value).valueOf();
              outRadius2slider.value=inRadius2slider.value;
              }
          }
    if(shape2==2){
            outradius2 = Number(1*outRadius2slider.value).valueOf();
            outRadius2text.innerHTML = (1*outRadius2slider.value).toFixed(2);
          }
    if(shape2==3){
              outradius2 = Number(1*outRadius2slider.value).valueOf();
              boxradius2 = (Math.sqrt(inRadius2slider.value*inRadius2slider.value)+(outRadius2slider.value*outRadius2slider.value));
              outRadius2text.innerHTML = Number(outRadius2slider.value).valueOf().toFixed(2);
          }
    document.getElementById("density2Range").value = density2;
    calculateDensity();
    density2text.innerHTML = density2.toFixed(2);
    };

// -------------------inradius 1----------------------------------------
  var inRadius1slider = document.getElementById("inRadius1Range");
  var inRadius1text = document.getElementById("inRadius1SliderValue");
  inRadius1text.innerHTML = (inradius1).toFixed(2); // Display the default slider value

  inRadius1slider.oninput = function() {
    if(shape1 == 3){
      inRadius1text.innerHTML = (1*inRadius1slider.value).toFixed(2);
      inradius1 = Number(inRadius1slider.value).valueOf();
      }
    if( (shape1 == 1)){
          if (inradius1<=outradius1){
                inRadius1text.innerHTML = Number(inRadius1slider.value).valueOf().toFixed(2);
                inradius1 = Number(inRadius1slider.value).valueOf();
                }
          if (inradius1>outradius1){
                inradius1 = outradius1;
                inRadius1slider.value   = outRadius1slider.value;
                inRadius1text.innerHTML = outRadius1text.innerHTML;
                }
      }
  document.getElementById("density1Range").value = density1;
  calculateDensity();
  density1text.innerHTML = density1.toFixed(2);
  };

// -------------------inradius 2----------------------------------------
var inRadius2slider = document.getElementById("inRadius2Range");
var inRadius2text = document.getElementById("inRadius2SliderValue");
inRadius2text.innerHTML = (inRadius2slider.value*1).toFixed(2);

inRadius2slider.oninput = function() {
  if(shape2 == 3){
    inRadius2text.innerHTML = (1*inRadius2slider.value).toFixed(2);
    inradius2 = Number(inRadius2slider.value).valueOf();
    }
  if( (shape2 == 1)){
        if (inradius2<=outradius2){
              inRadius2text.innerHTML = Number(inRadius2slider.value).valueOf().toFixed(2);
              inradius2 = Number(inRadius2slider.value).valueOf();
              }
        if (inradius2>outradius2){
              inradius2 = outradius2;
              inRadius2slider.value   = outRadius2slider.value;
              inRadius2text.innerHTML = outRadius2text.innerHTML;
              }
    }
    document.getElementById("density2Range").value = density2;
    calculateDensity();
    density2text.innerHTML = density2.toFixed(2);
  };
//-------------------VIEW Angle----------------------------------
var persslider = document.getElementById("persRange");
document.getElementById("persRange").value = persangle;
var perstext = document.getElementById("persSliderValue");
perstext.innerHTML = "View Angle: "+(1*persslider.value).toFixed(2)+"&#960;"+" rad";

persslider.oninput = function() {
    perstext.innerHTML = "View Angle :  "+(1*persslider.value).toFixed(2)+"&#960;"+" rad";
    persangle = Number(persslider.value).valueOf();
    if(persangle == 0){persangle = 0.000001};
    length1 = Number(length1slider.value).valueOf();
    length1 = Math.sin(persangle*Math.PI) * length1;
    length2 = Number(length2slider.value).valueOf();
    length2 = Math.sin(persangle*Math.PI) * length2;
 };

 //-------------------Computer speed----------------------------------
 var computerword = "it's fast";
 var computerslider = document.getElementById("computerRange");
 document.getElementById("computerRange").value = compspeed;
 var computertext = document.getElementById("computerSliderValue");
 computertext.innerHTML = "My computer Speed: "+computerword;

 computerslider.oninput = function() {
    compspeed = Number(computerslider.value).valueOf();
    if (compspeed > 0.7){computerword = "it's fast"}
        else if(compspeed > 0.4){computerword = "not too great"}
             else computerword = "sooo slow";
     computertext.innerHTML = "Computer Speed: "+computerword;
     if (compspeed == 0){compspeed = 0.1};
  };

checkFontSizer();
calculateDensity();

document.getElementById('collideButton').style.color = 'white';
document.getElementById('mathButton').style.color = 'white';

//____________________________ DRAW FUNCTION._____________________________
function draw() {

   ctx.clearRect(0, 0, canvas1.width, canvas1.height);
   collideButton;

   if(collidenow == true){
       if (shape1 == 1){
           document.getElementById("cylinder1").disabled = true;
           document.getElementById("box1").disabled = true;
       }
       if (shape1 == 2){
           document.getElementById("hoop1").disabled = true;
           document.getElementById("box1").disabled = true;
       }
       if (shape1 == 3){
           document.getElementById("hoop1").disabled = true;
           document.getElementById("cylinder1").disabled = true;
       }
       if (shape2 == 1){
           document.getElementById("cylinder2").disabled = true;
           document.getElementById("box2").disabled = true;
       }
       if (shape2 == 2){
           document.getElementById("hoop2").disabled = true;
           document.getElementById("box2").disabled = true;
       }
       if (shape2 == 3){
           document.getElementById("hoop2").disabled = true;
           document.getElementById("cylinder2").disabled = true;
       }

       document.getElementById("v1Range").disabled = true;
    //   document.getElementById("mass1Range").disabled = true;
    //   document.getElementById("density1Range").disabled = true;
    //   document.getElementById("length1Range").disabled = true;
    //   document.getElementById("outRadius1Range").disabled = true;
    //   document.getElementById("inRadius1Range").disabled = true;
       document.getElementById("v2Range").disabled = true;
    //   document.getElementById("mass2Range").disabled = true;
    //   document.getElementById("density2Range").disabled = true;
    //   document.getElementById("length2Range").disabled = true;
    //   document.getElementById("outRadius2Range").disabled = true;
    //   document.getElementById("inRadius2Range").disabled = true;
   }

   if(collidenow == false){
       document.getElementById("hoop1").disabled = false;
       document.getElementById("cylinder1").disabled = false;
       document.getElementById("box1").disabled = false;
       document.getElementById("hoop2").disabled = false;
       document.getElementById("cylinder2").disabled = false;
       document.getElementById("box2").disabled = false;
       document.getElementById("v1Range").disabled = false;
      // document.getElementById("mass1Range").disabled = false;
       //document.getElementById("density1Range").disabled = false;
       //document.getElementById("length1Range").disabled = false;
       //document.getElementById("outRadius1Range").disabled = false;
       //document.getElementById("inRadius1Range").disabled = false;
       document.getElementById("v2Range").disabled = false;
       //document.getElementById("mass2Range").disabled = false;
       //document.getElementById("density2Range").disabled = false;
       //document.getElementById("length2Range").disabled = false;
       //document.getElementById("outRadius2Range").disabled = false;
       //document.getElementById("inRadius2Range").disabled = false;
   }

   if(collidenow == false){
       if(shape1 == 2){
           document.getElementById("inRadius1Range").disabled = true;}
              else {
                  document.getElementById("inRadius1Range").disabled = false;
                }
       if(shape2 == 2){
           document.getElementById("inRadius2Range").disabled = true;
              }
              else {
                document.getElementById("inRadius2Range").disabled = false;
                }
       }

  canvas1.width  = window.innerWidth;
  canvas1.height = window.innerHeight;

  canvas2.width  = window.innerWidth;
  canvas2.height = window.innerHeight;

  canvas3.width  = window.innerWidth;
  canvas3.height = window.innerHeight;

  canvas4.width  = window.innerWidth;
  canvas4.height = window.innerHeight;

  aspectconstant = canvas1.height * 0.55 / canvas1.width
  checkFontSizer();
  htmltextchange();

  ctx.fillStyle = "grey";
  ctx.font = "30px Arial";
  ctx.fillText("RotationalCollisioner" ,(canvas1.width*0.84),(0.05*canvas1.height),canvas1.width*0.14);

  if ((shape1 == 1) && (shape2 == 1)){
            document.getElementById("valueabbrev").innerHTML = "ω: ANGULAR VELOCITY <br>M: MASS <br> X: LENGTH <br>    R: OUTER RADIUS                 <br>    r: INNER RADIUS          <br> ρ: DENSITY"};
  if ((shape1 == 1) && (shape2 == 2)){
            document.getElementById("valueabbrev").innerHTML = "ω: ANGULAR VELOCITY <br>M: MASS <br> X: LENGTH <br>    R: OUTER RADIUS                 <br> &#x2190; r: INNER RADIUS          <br> ρ: DENSITY"};
  if ((shape1 == 1) && (shape2 == 3)){
            document.getElementById("valueabbrev").innerHTML = "ω: ANGULAR VELOCITY <br>M: MASS <br> X: LENGTH <br> &#x2190; R: OUTER RADIUS | H: HEIGHT &#x2192;  <br> &#x2190; r: INNER RADIUS | W: WIDTH &#x2192;<br> ρ: DENSITY"};

  if ((shape1 == 2) && (shape2 == 1)){
            document.getElementById("valueabbrev").innerHTML = "ω: ANGULAR VELOCITY <br>M: MASS <br> X: LENGTH <br>    R: OUTER RADIUS                 <br> r: INNER RADIUS &#x2192;          <br> ρ: DENSITY"};
  if ((shape1 == 2) && (shape2 == 2)){
            document.getElementById("valueabbrev").innerHTML = "ω: ANGULAR VELOCITY <br>M: MASS <br> X: LENGTH <br>    R: OUTER RADIUS                 <br>                          <br> ρ: DENSITY"};
  if ((shape1 == 2) && (shape2 == 3)){
            document.getElementById("valueabbrev").innerHTML = "ω: ANGULAR VELOCITY <br>M: MASS <br> X: LENGTH <br> &#x2190; R: OUTER RADIUS | H: HEIGHT &#x2192;  <br> W: WIDTH &#x2192;               <br> ρ: DENSITY"};

  if ((shape1 == 3) && (shape2 == 1)){
            document.getElementById("valueabbrev").innerHTML = "ω: ANGULAR VELOCITY <br>M: MASS <br> X: LENGTH <br> &#x2190; H: HEIGHT | R: OUTER RADIUS &#x2192;  <br> &#x2190; W: WIDTH | r: INNER RADIUS &#x2192; <br> ρ: DENSITY"};
  if ((shape1 == 3) && (shape2 == 2)){
            document.getElementById("valueabbrev").innerHTML = "ω: ANGULAR VELOCITY <br>M: MASS <br> X: LENGTH <br> &#x2190; H: HEIGHT | R: OUTER RADIUS &#x2192;  <br> &#x2190; W: WIDTH                 <br> ρ: DENSITY"};
  if ((shape1 == 3) && (shape2 == 3)){
            document.getElementById("valueabbrev").innerHTML = "ω: ANGULAR VELOCITY <br>M: MASS <br> X: LENGTH <br> H: HEIGHT                       <br> W: WIDTH                 <br> ρ: DENSITY"};

//++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++

  XX1 = (canvas1.width*0.5)-(canvas1.width*0.1*Math.sin(persangle*Math.PI))+passCount1;
  XX2 = (canvas1.width*0.5)+(canvas1.width*0.1*Math.sin(persangle*Math.PI))-passCount2;
  YY  = (canvas1.height*0.25);

  if (collidenow == true){
              if(XX1 <= canvas1.width*0.5){passCount1 = passCount1*1.2;};
              if(XX1 >  canvas1.width*0.5){XX1 = (canvas1.width*0.5);};

              if(XX2 >= ((canvas1.width*0.5))){passCount2 = passCount2*1.2;};
              if(XX2 <  canvas1.width*0.5){XX2 = (canvas1.width*0.5);};
    }

  if (collidenow == false ){
            XX1 = (canvas1.width*0.5)-(canvas1.width*0.1*Math.sin(persangle*Math.PI));
            XX2 = (canvas1.width*0.5)+(canvas1.width*0.1*Math.sin(persangle*Math.PI));
            passCount1 =0.1;
            passCount2 =0.1;
    }

  if ((collidenow == true) && (XX1 >= (canvas1.width * 0.5))){
            storecount = true;
            v1 = v3;
            v2 = v3;
    }

  if ((collidenow == false) && (XX1 < (canvas1.width * 0.5))){
      if(storecount == true){
         v1 = storedv1;
         v2 = storedv2;
         v1box = storedv1box;
         v2box = storedv2box;
         storecount = false;
      }
  }

  document.addEventListener('keydown', InfoBoxErase);
  document.body.onmousedown = InfoBoxErase;

//______________cylinderand and ring________________________
  if(shape1 != 3){
    // outRadius1text.innerHTML = Number(outRadius1slider.value).valueOf().toFixed(2);
       ctx2.strokeStyle = "Maroon";
       ctx.lineWidth = 3;
       ctx.fillStyle = color1;

       ctx.beginPath();
       ctx.ellipse((XX1)-(length1*(canvas1.width*0.05)), YY, Math.cos(persangle*Math.PI)*canvas1.width*outradius1*aspectconstant/10, canvas1.height*outradius1/10, 0, 0, 2* Math.PI)
       ctx.ellipse(XX1, YY, Math.cos(persangle*Math.PI)*canvas1.width*outradius1*aspectconstant/10, canvas1.height*outradius1/10, 0, 0, 2 * Math.PI);
       ctx.closePath();
       ctx.fill();

       ctx.beginPath();
       ctx.rect(XX1-((length1*(canvas1.width*0.05))), YY-(canvas1.height*outradius1/10), +length1*(canvas1.width*0.05), canvas1.height*outradius1/5)
       ctx.closePath();
       ctx.fill();

       if (shape1 == 1){
            ctx.beginPath();
            ctx.fillStyle = 'white';
            ctx.globalAlpha = 0;
            ctx.ellipse(XX1, YY, Math.cos(persangle*Math.PI)*canvas1.width*inradius1*aspectconstant/10, canvas1.height*inradius1/10, 0, 0, 2 * Math.PI);
        //    ctx.ellipse((XX1)-(length1*(canvas1.width*0.05)), YY, Math.cos(persangle*Math.PI)*canvas1.width*inradius1*aspectconstant/10, canvas1.height*inradius1/10, 0, 0, 2* Math.PI);
            ctx.globalAlpha = 1;
            ctx.closePath();
            ctx.fill();
          }

       // left outer circles of cylinder
       ctx2.beginPath();
       ctx2.lineWidth = 4;
       ctx2.ellipse((XX1)-(length1*(canvas1.width*0.05)), YY, Math.cos(persangle*Math.PI)*canvas1.width*outradius1*aspectconstant/10, canvas1.height*outradius1/10, 0, 0.5*Math.PI, 1.5* Math.PI);
       ctx2.stroke();
       ctx2.closePath();
       ctx2.lineWidth = 2;

       ctx2.beginPath();
       ctx2.setLineDash([5, 5]);
       ctx2.lineWidth = 1;
       ctx2.ellipse((XX1)-(length1*(canvas1.width*0.05)), YY, Math.cos(persangle*Math.PI)*canvas1.width*outradius1*aspectconstant/10, canvas1.height*outradius1/10, 0, 0, 2* Math.PI);
       ctx2.stroke();
       ctx2.setLineDash([]);
       ctx2.closePath();

      //two outer lines of cylinder
       ctx2.beginPath();
       ctx2.lineWidth = 4;
       ctx2.moveTo(XX1-(length1*(canvas1.width*0.05)), YY+(canvas1.height*outradius1/10));
       ctx2.lineTo(XX1, (YY)+(canvas1.height*outradius1/10));
       ctx2.moveTo(XX1-(length1*(canvas1.width*0.05)), YY-(canvas1.height*outradius1/10));
       ctx2.lineTo(XX1, (YY)-(canvas1.height*outradius1/10));
       ctx2.stroke();
       ctx2.closePath();

       //two inner lines of cylinder
       if(shape1 == 1 && inradius1>0){
            ctx2.lineWidth = 4;
            ctx2.beginPath();
            ctx2.setLineDash([5, 5]);
            ctx2.moveTo(XX1-(length1*(canvas1.width*0.05)), YY+(canvas1.height*inradius1/10));
            ctx2.lineTo(XX1, YY+(canvas1.height*inradius1/10));
            ctx2.moveTo(XX1-(length1*(canvas1.width*0.05)), YY-(canvas1.height*inradius1/10));
            ctx2.lineTo(XX1, YY-(canvas1.height*inradius1/10));
            ctx2.stroke();
            ctx2.setLineDash([]);
            ctx2.closePath();
            }

    //right hand circle of cylinder
      if(shape1 == 1 && inradius1>0){
            ctx2.lineWidth = 4;
            ctx2.beginPath();
            ctx2.setLineDash([5, 5]);
            ctx2.ellipse((XX1)-(length1*(canvas1.width*0.05)), YY, Math.cos(persangle*Math.PI)*canvas1.width*inradius1*aspectconstant/10, canvas1.height*inradius1/10, 0, 0, 2* Math.PI);
            ctx2.stroke();
            ctx2.setLineDash([]);
            ctx2.closePath();
        }

        //right inner and outer circles
       ctx2.lineWidth = 4;
       ctx2.beginPath();
       ctx2.ellipse(XX1, YY, Math.cos(persangle*Math.PI)*canvas1.width*outradius1*aspectconstant/10, canvas1.height*outradius1/10, 0, 0, 2 * Math.PI);
       ctx2.stroke();
       ctx2.closePath();

       if(shape1 == 1){
           ctx2.beginPath();
           ctx2.lineWidth = 4;
           ctx2.ellipse(XX1, YY, Math.cos(persangle*Math.PI)*canvas1.width*inradius1*aspectconstant/10, canvas1.height*inradius1/10, 0, 0, 2 * Math.PI);
           ctx2.stroke();
           ctx2.closePath();
         }

       ctx2.lineWidth = 2;

      //rotating lines________________________________________________________

  click1 = -1;
  var increment1 = v1 * 0.00025 * Math.PI /compspeed;
  turnIncrement1= incCounter1*increment1;
  incCounter1=incCounter1 + 1;
  ctx2.lineWidth = 4;
  ctx2.strokeStyle = "red";

  while(click1 <= 1){
      oldlineY1 = lineY1;
      incCounter1=incCounter1 + 1;
      ctx2.lineWidth = 6;

      if(length1   >=0.09){lineX1end   = (XX1)                                   -(canvas1.width*0.1*Math.cos(persangle*Math.PI)*aspectconstant*outradius1*(Math.cos((2*Math.PI*click1)+turnIncrement1)));}
      if(length1   <=0.09){lineX1end   = (XX1)                                   -(canvas1.width*0.1*Math.cos(persangle*Math.PI)*aspectconstant*outradius1*(Math.cos((2*Math.PI*click1)+turnIncrement1)))+8;}

      if(lineX1end <= XX1){lineX1begin = (XX1)  -(0.05 * length1 * canvas1.width)-(canvas1.width*0.1*Math.cos(persangle*Math.PI)*aspectconstant*outradius1*(Math.cos((2*Math.PI*click1)+turnIncrement1)));}
      if(lineX1end >= XX1){lineX1begin = (XX1)                                   -(canvas1.width*0.1*Math.cos(persangle*Math.PI)*aspectconstant*outradius1*(Math.cos((2*Math.PI*click1)+turnIncrement1)));}

      if(length1   >=0.09){lineY1  = YY  +(canvas1.height*0.1*outradius1*(Math.sin((2*Math.PI*click1)+turnIncrement1)));}
      if(length1   < 0.09){lineY1  = YY  +(canvas1.height*0.1*outradius1*(Math.sin((2*Math.PI*click1)+turnIncrement1)));}

      if(persangle>=0){
          ctx2.beginPath();
          ctx2.moveTo(lineX1begin, lineY1);
          ctx2.lineTo(lineX1end, lineY1);
          ctx2.stroke();
          ctx2.closePath();
        }
      if(persangle==0.5){
          lineX1end   = (XX1)                                   -(canvas1.width*0.1*Math.cos(persangle*Math.PI)*aspectconstant*outradius1*(Math.cos((2*Math.PI*click1)+turnIncrement1)));
          if(XX1>canvas1.width*0.5){XX1=canvas1.width*0.5}
          lineX1begin = (XX1)  -(0.05 * length1 * canvas1.width)-(canvas1.width*0.1*Math.cos(persangle*Math.PI)*aspectconstant*outradius1*(Math.cos((2*Math.PI*click1)+turnIncrement1)));

          if((v1>=0)&&(lineY1>=oldlineY1)){
                ctx2.beginPath();
                ctx2.moveTo(lineX1begin, lineY1);
                ctx2.lineTo(lineX1end, lineY1);
                ctx2.stroke();
                ctx2.closePath();
              }
          if((v1<=0)&&(lineY1>oldlineY1)){
                ctx2.beginPath();
                ctx2.moveTo(lineX1begin, lineY1);
                ctx2.lineTo(lineX1end, lineY1);
                ctx2.stroke();
                ctx2.closePath();
               }
        }

      ctx2.lineWidth = 0.5;
      ctx2.beginPath();
      ctx2.setLineDash([5, 5]);

      if(length1 >0.09){
            lineX1end   = XX1                                   -(canvas1.width*Math.cos(persangle*Math.PI)*0.1*aspectconstant*outradius1*(Math.cos((2*Math.PI*click1)+turnIncrement1)));
            if(XX1>canvas1.width*0.5){XX1=canvas1.width*0.5}
      }
      if(length1 <=0.09){
            lineX1end   = XX1                                   -(canvas1.width*Math.cos(persangle*Math.PI)*0.11*aspectconstant*outradius1*(Math.cos((2*Math.PI*click1)+turnIncrement1)));
            if(XX1>canvas1.width*0.5){XX1=canvas1.width*0.5}
      }
      if(lineX1end >= XX1){
            lineX1begin = XX1  -(0.05 * length1 * canvas1.width)-(canvas1.width*Math.cos(persangle*Math.PI)*0.1*aspectconstant*outradius1*(Math.cos((2*Math.PI*click1)+turnIncrement1)));
            if(XX1>canvas1.width*0.5){XX1=canvas1.width*0.5}
      }
      if(lineX1end < XX1){
            lineX1begin = XX1                                   -(canvas1.width*Math.cos(persangle*Math.PI)*0.1*aspectconstant*outradius1*(Math.cos((2*Math.PI*click1)+turnIncrement1)));
            if(XX1>canvas1.width*0.5){XX1=canvas1.width*0.5}
      }
      lineY1 = YY  +(0.1*canvas1.height*outradius1*(Math.sin((2*Math.PI*click1)+turnIncrement1)));
      ctx2.moveTo(lineX1begin, lineY1);
      ctx2.lineTo(lineX1end, lineY1);
      ctx2.stroke();
      ctx2.setLineDash([]);
      ctx2.closePath();
      click1 = click1 + 0.05 ;
    }

      ctx4.strokeStyle = "green";
      ctx4.beginPath();
      ctx4.lineWidth = 5;
      ctx4.fillStyle = "green"
      ctx4.ellipse(XX1- (0.5* 0.05 * length1 * canvas1.width), YY, 8*aspectconstant, 8, 0, 0, 2 * Math.PI);
      ctx4.stroke();
      ctx4.fill();
      ctx4.closePath();
      ctx4.strokeStyle = "red";

      if (incCounter1 == 800*compspeed/v1){incCounter1 = 0};
}


//______________cylinder and ring________________________
if (shape2 != 3){
     ctx4.strokeStyle = "DarkBlue";
     ctx4.lineWidth = 3;
     ctx3.fillStyle = color2;

     ctx3.beginPath();
     ctx3.ellipse(XX2, YY, Math.cos(persangle*Math.PI)*canvas1.width*outradius2*aspectconstant/10, canvas1.height*outradius2/10, 0, 0, 2* Math.PI)
     ctx3.ellipse(XX2+(length2*(canvas1.width*0.05)), YY, Math.cos(persangle*Math.PI)*canvas1.width*outradius2*aspectconstant/10, canvas1.height*outradius2/10, 0, 0, 2 * Math.PI);
     ctx3.closePath();
     ctx3.fill();

     ctx3.beginPath();
     ctx3.rect(XX2, YY-(canvas1.height*outradius2/10), +length2*(canvas1.width*0.05), canvas1.height*outradius2/5)
     ctx3.closePath();
     ctx3.fill();

     if (shape2 == 1){
          ctx3.beginPath();
          ctx3.fillStyle = 'white';
          ctx3.ellipse(XX2+(length2*(canvas1.width*0.05)), YY, Math.cos(persangle*Math.PI)*canvas1.width*inradius2*aspectconstant/10, canvas1.height*inradius2/10, 0, 0, 2* Math.PI);
          ctx3.closePath();
          ctx3.fill();
        }

     // left outer circles of cylinder
     ctx4.beginPath();
     ctx4.lineWidth = 4;
     ctx4.ellipse((XX2), YY, Math.cos(persangle*Math.PI)*canvas1.width*outradius2*aspectconstant/10, 0.1*canvas1.height*outradius2, 0, 0.5*Math.PI, 1.5* Math.PI);
     ctx4.stroke();
     ctx4.setLineDash([5, 5]);
     ctx4.beginPath();
     ctx4.lineWidth = 2;
     ctx4.ellipse((XX2), YY, Math.cos(persangle*Math.PI)*canvas1.width*outradius2*aspectconstant/10, canvas1.height*outradius2/10, 0, 0, 2* Math.PI);
     ctx4.stroke();
     ctx4.setLineDash([]);
     ctx4.closePath();

    //two outer lines of cylinder
     ctx4.beginPath();
     ctx4.lineWidth = 4;
     ctx4.moveTo(XX2+(length2*(canvas1.width*0.05)), YY+(canvas1.height*outradius2/10));
     ctx4.lineTo(XX2, (YY)+(canvas1.height*outradius2/10));
     ctx4.moveTo(XX2+(length2*(canvas1.width*0.05)), YY-(canvas1.height*outradius2/10));
     ctx4.lineTo(XX2, (YY)-(canvas1.height*outradius2/10));
     ctx4.stroke();
     ctx4.closePath();

     //two inner lines of cylinder
     if(shape2 == 1 && inradius2>0){
          ctx4.lineWidth = 4;
          ctx4.beginPath();
          ctx4.setLineDash([5, 5]);
          ctx4.moveTo(XX2+(length2*(canvas1.width*0.05)), YY+(canvas1.height*inradius2/10));
          ctx4.lineTo(XX2, YY+(canvas1.height*inradius2/10));
          ctx4.moveTo(XX2+(length2*(canvas1.width*0.05)), YY-(canvas1.height*inradius2/10));
          ctx4.lineTo(XX2, YY-(canvas1.height*inradius2/10));
          ctx4.stroke();
          ctx4.setLineDash([]);
          ctx4.closePath();
      }

      //left inner circle of cylinder
      if(shape2 == 1 && inradius2>0){
          ctx4.lineWidth = 2;
          ctx4.beginPath();
          ctx4.setLineDash([5, 5]);
          ctx4.ellipse(XX2, YY, Math.cos(persangle*Math.PI)*canvas1.width*inradius2*aspectconstant/10, canvas1.height*inradius2/10, 0, 0, 2* Math.PI);
          ctx4.stroke();
          ctx4.setLineDash([]);
          ctx4.closePath();
        }

  //right inner and outer circles
     ctx4.lineWidth = 4;
     ctx4.beginPath();
     ctx4.ellipse(XX2+(length2*(canvas1.width*0.05)), YY, Math.cos(persangle*Math.PI)*canvas1.width*outradius2*aspectconstant/10, canvas1.height*outradius2/10, 0, 0, 2 * Math.PI);
     ctx4.stroke();
     ctx4.closePath();

     if(shape2 == 1){
         ctx4.beginPath();
         ctx4.lineWidth = 4;
         ctx4.ellipse(XX2+(length2*(canvas1.width*0.05)), YY, Math.cos(persangle*Math.PI)*canvas1.width*inradius2*aspectconstant/10, canvas1.height*inradius2/10, 0, 0, 2 * Math.PI);
         ctx4.stroke();
         ctx4.closePath();
       }

  //rotating lines________________________________________________________
    click2 = -1;
    var increment2 = v2 * 0.00025 * Math.PI/compspeed;
    turnincrement2= incCounter2*increment2;
    incCounter2=incCounter2 + 1;
    ctx4.lineWidth = 4;
    ctx4.strokeStyle = "blue";

    while(click2 < 1){
        incCounter2=incCounter2 + 1;
        ctx4.lineWidth = 6;
        ctx4.beginPath();

        if(length2<=0.09){lineX2begin = (XX2)  +(0.05 * length2 * canvas1.width)   -(canvas1.width*0.1*aspectconstant*Math.cos(persangle*Math.PI)*outradius2*(Math.cos((2*Math.PI*click2)+turnincrement2)))+8;}
        if(length2> 0.09){lineX2begin = (XX2)  +(0.05 * length2 * canvas1.width)   -(canvas1.width*0.1*aspectconstant*Math.cos(persangle*Math.PI)*outradius2*(Math.cos((2*Math.PI*click2)+turnincrement2)));}

        if (XX2<  XX2 -(canvas1.width*0.01*outradius2*(Math.cos((2*Math.PI*click2)+turnincrement2))))  {lineX2end   = (XX2) +(0.05 * length2 * canvas1.width) -(canvas1.width*0.1*aspectconstant*Math.cos(persangle*Math.PI)*outradius2*(Math.cos((2*Math.PI*click2)+turnincrement2)));}
        if (XX2>= XX2 -(canvas1.width*0.01*outradius2*(Math.cos((2*Math.PI*click2)+turnincrement2))))  {lineX2end   = (XX2)                                   -(canvas1.width*0.1*aspectconstant*Math.cos(persangle*Math.PI)*outradius2*(Math.cos((2*Math.PI*click2)+turnincrement2)));}

        lineY2   = YY  +(canvas1.height*outradius2*(Math.sin((2*Math.PI*click2)+turnincrement2))/10);
        ctx4.moveTo(lineX2begin, lineY2);
        ctx4.lineTo(lineX2end, lineY2);
        ctx4.stroke();
        ctx4.closePath();

        ctx4.lineWidth = 0.5;

        ctx4.beginPath();
        ctx4.setLineDash([5, 5]);
        if(length2<=0.09){lineX2begin = (XX2)  +(0.05 * length2 * canvas1.width)   -(canvas1.width*0.1*aspectconstant*Math.cos(persangle*Math.PI)*outradius2*(Math.cos((2*Math.PI*click2)+turnincrement2)))+4;}
        if(length2> 0.09){lineX2begin = (XX2)  +(0.05 * length2 * canvas1.width)   -(canvas1.width*0.1*aspectconstant*Math.cos(persangle*Math.PI)*outradius2*(Math.cos((2*Math.PI*click2)+turnincrement2)));}
        if (XX2>  XX2 -(canvas1.width*0.01*outradius2*(Math.cos((2*Math.PI*click2)+turnincrement2))))  {lineX2end   = (XX2) +(0.05 * length2 * canvas1.width) -(canvas1.width*0.1*aspectconstant*Math.cos(persangle*Math.PI)*outradius2*(Math.cos((2*Math.PI*click2)+turnincrement2)));}
        if (XX2<= XX2 -(canvas1.width*0.01*outradius2*(Math.cos((2*Math.PI*click2)+turnincrement2))))  {lineX2end   = (XX2)                                   -(canvas1.width*0.1*aspectconstant*Math.cos(persangle*Math.PI)*outradius2*(Math.cos((2*Math.PI*click2)+turnincrement2)));}
        lineY2   = YY  +(0.1*canvas1.height*outradius2*(Math.sin((2*Math.PI*click2)+turnincrement2)));
        ctx4.moveTo(lineX2begin, lineY2);
        ctx4.lineTo(lineX2end, lineY2);
        ctx4.stroke();
        ctx4.setLineDash([]);
        ctx4.closePath();
        click2 = click2 + 0.05 ;
    }
    ctx4.strokeStyle = "green";
    ctx4.fillStyle = "green"
    ctx4.beginPath();
    ctx4.lineWidth = 4;
    ctx4.ellipse(XX2+(length2*0.5*(canvas1.width*0.05)), YY, 8*aspectconstant, 8, 0, 0, 2 * Math.PI);
    ctx4.stroke();
    ctx4.fill();
    ctx4.closePath();
    ctx4.strokeStyle = "darkBlue";
    if (incCounter2 == 800*compspeed/v2){incCounter2 = 0};
  }


//  Box 1 ___________________________________________________
if (shape1 ==3) {
    oldXX1 = XX1;
    XX1 = XX1- (length1*(canvas1.width*0.05));

    if(collidenow == false){
        beforecollisionv1 = v1;
        beforecollisionv2 = v2;
      }
    width1  = outradius1;
    height1 = inradius1;
    boxradius1 = (Math.sqrt((width1*width1)+(height1*height1)));

    oldv1box = v1box;
    v1box    = -v1box;

    click1 = -1;

    if((collidenow == true) && (XX2<=((canvas1.width*0.5)))){v1box = -v3box}

    var increment1 = v1box * 0.0025 * Math.PI/compspeed;
    turnIncrement1 = incCounterbox1*increment1;

    //while(click1 < 0.5){
    while(click1 < 1){
        incCounterbox1 = incCounterbox1 + 1;

        oldlineX1begin = lineX1begin;
        oldlineX1end   = lineX1end;
        oldlineY1      = lineY1;

        lineX1begin   = XX1                                    + (canvas1.width * 0.1 * Math.cos(persangle*Math.PI)*aspectconstant*boxradius1*(Math.cos((2*Math.PI*click1)+turnIncrement1)));
        lineX1end     = XX1  +(0.05 * length1 * canvas1.width) + (canvas1.width * 0.1 * Math.cos(persangle*Math.PI)*aspectconstant*boxradius1*(Math.cos((2*Math.PI*click1)+turnIncrement1)));
        lineY1        = YY                                     + (canvas1.height* 0.1 * boxradius1*(Math.sin((2*Math.PI*click1)                                           +turnIncrement1)));

// ______________avoiding writing a ton of arrays... ________________
        AAX5begin = AAX4begin;
        AAY5begin = AAY4begin;
        AAX5end   = AAX4end;
        AAY5end   = AAY4end;
//_________________
        AAX4begin = AAX3begin;
        AAY4begin = AAY3begin;
        AAX4end   = AAX3end;
        AAY4end   = AAY3end;
        //_________________
        AAX3begin = AAX2begin;
        AAY3begin = AAY2begin;
        AAX3end   = AAX2end;
        AAY3end   = AAY2end;
        //_________________
        AAX2begin = AAX1begin;
        AAY2begin = AAY1begin;
        AAX2end   = AAX1end;
        AAY2end   = AAY1end;
        //_________________
        AAX1begin = lineX1begin;
        AAY1begin = lineY1;
        AAX1end   = lineX1end;
        AAY1end   = lineY1;

//left box shading
        ctx.lineWidth = 3;
        ctx.fillStyle = color1;
        ctx.beginPath();

        ctx.moveTo(AAX1begin, AAY1begin);
        ctx.lineTo(AAX1end,   AAY1end);
        ctx.lineTo(AAX2end,   AAY2end);
        ctx.lineTo(AAX2begin, AAY2begin);
        ctx.lineTo(AAX1begin, AAY1begin);

        ctx.lineTo(AAX1begin, AAY1begin);
        ctx.lineTo(AAX2begin, AAY2begin);
        ctx.lineTo(AAX3begin, AAY3begin);
        ctx.lineTo(AAX4begin, AAY4begin);
        ctx.lineTo(AAX1begin, AAY1begin);
        ctx.closePath();

        ctx.fill();

              //______Box side lines_______________________
        //below contains all left hand end points of the 'line in front' (solid).
        ctx2.strokeStyle = "Maroon";

        if ((lineY1 <= oldlineY1)||(persangle ==0.5)){
            ctx2.lineWidth = 4;
            ctx2.beginPath();
            ctx2.moveTo(oldlineX1begin,oldlineY1);
            ctx2.lineTo(lineX1begin,lineY1);
            ctx2.stroke();
            ctx2.closePath();
        }

        ctx2.lineWidth = 4;
        ctx2.beginPath();
        ctx2.moveTo(oldlineX1end,oldlineY1);
        ctx2.lineTo(lineX1end,lineY1);
        ctx2.stroke();
        ctx2.closePath();

        if ((lineY1 >= oldlineY1)||(persangle ==0.5)){
              ctx2.lineWidth = 0.5;
              ctx2.beginPath();
              ctx2.setLineDash([5, 5]);
              ctx2.moveTo(oldlineX1begin, oldlineY1);
              ctx2.lineTo(lineX1begin, lineY1);
              ctx2.stroke();
              ctx2.setLineDash([]);
              ctx2.closePath();
          }
        if(v1box<=0){
          if (lineY1 > YY){
              if((lineX1begin >=  XX1) && (lineY1<=oldlineY1)||(lineX1begin <= oldlineX1begin)){
                  ctx2.lineWidth = 4;
                  ctx2.beginPath();
                  ctx2.moveTo(lineX1end, lineY1);
                  ctx2.lineTo(lineX1begin  , lineY1);
                  ctx2.stroke();
                  ctx2.closePath();
                  }
              if(((lineX1begin >=  XX1 )||(persangle ==0.5)) && (lineY1>=oldlineY1)||(lineX1begin >= oldlineX1begin)){
                  ctx2.lineWidth = 0.5;
                  ctx2.beginPath();
                  ctx2.setLineDash([5, 5]);
                  ctx2.moveTo(lineX1end, lineY1);
                  ctx2.lineTo(lineX1begin  , lineY1);
                  ctx2.stroke();
                  ctx2.setLineDash([]);
                  ctx2.closePath();
                    }
            }
        if (lineY1 <= YY){
          if((lineX1begin <= XX1) ||(persangle ==0.5) ){
            ctx2.lineWidth = 4;
            ctx2.beginPath();
            ctx2.moveTo(lineX1end, lineY1);
            ctx2.lineTo(lineX1begin  , lineY1);
            ctx2.stroke();
            ctx2.closePath();
            }
        if((lineX1begin >= XX1)||(persangle ==0.5)){
            ctx2.lineWidth =0.5;
            ctx2.beginPath();
            ctx2.setLineDash([5, 5]);
            ctx2.moveTo(lineX1end, lineY1);
            ctx2.lineTo(lineX1begin  , lineY1);
            ctx2.stroke();
            ctx2.setLineDash([]);
            ctx2.closePath();
              }
        if((lineX1begin >=  XX1||(persangle ==0.5)) && (lineY1<=oldlineY1)){
            ctx2.lineWidth = 4;
            ctx2.beginPath();
            ctx2.moveTo(lineX1end, lineY1);
            ctx2.lineTo(lineX1begin  , lineY1);
            ctx2.stroke();
            ctx2.closePath();
            }
        if(((lineX1begin >= XX1)||(persangle ==0.5)) && (lineY1>=oldlineY1)){
            ctx2.lineWidth = 0.5;
            ctx2.beginPath();
            ctx2.setLineDash([5, 5]);
            ctx2.moveTo(lineX1end, lineY1);
            ctx2.lineTo(lineX1begin  , lineY1);
            ctx2.stroke();
            ctx2.setLineDash([]);
            ctx2.closePath();
            }
          }
  }

  if(v1box>0){
      if (lineY1 >= YY){
          if((lineX1end <= XX1) && (lineY1<oldlineY1)&&(lineX1end >= oldlineX1end)){
            ctx2.lineWidth = 4;
            ctx2.beginPath();
            ctx2.moveTo(lineX1end, lineY1);
            ctx2.lineTo(lineX1begin  , lineY1);
            ctx2.stroke();
            ctx2.closePath();
            }
          if(((lineX1end <= XX1)||(persangle ==0.5)) && (lineY1>=oldlineY1)&&(lineX1end <= oldlineX1end)){
            ctx2.lineWidth = 0.5;
            ctx2.beginPath();
            ctx2.setLineDash([5, 5]);
            ctx2.moveTo(lineX1end, lineY1);
            ctx2.lineTo(lineX1begin  , lineY1);
            ctx2.stroke();
            ctx2.setLineDash([]);
            ctx2.closePath();
            }
          if((lineX1end >=  XX1) && (lineY1<=oldlineY1)||(lineX1end <= oldlineX1end)){
            ctx2.lineWidth = 4;
            ctx2.beginPath();
            ctx2.moveTo(lineX1end, lineY1);
            ctx2.lineTo(lineX1begin  , lineY1);
            ctx2.stroke();
            ctx2.closePath();
            }
          if(((lineX1end >=  XX1)||(persangle ==0.5)) && (lineY1>=oldlineY1)||(lineX1end >= oldlineX1end)){
            ctx2.lineWidth = 0.5;
            ctx2.beginPath();
            ctx2.setLineDash([5, 5]);
            ctx2.moveTo(lineX1end, lineY1);
            ctx2.lineTo(lineX1begin  , lineY1);
            ctx2.stroke();
            ctx2.setLineDash([]);
            ctx2.closePath();
            }
        }
    if (lineY1 <= YY){
          if((lineX1end <= XX1)){
            ctx2.lineWidth = 4;
            ctx2.beginPath();
            ctx2.moveTo(lineX1end, lineY1);
            ctx2.lineTo(lineX1begin  , lineY1);
            ctx2.stroke();
            ctx2.closePath();
            }
          if((lineX1end >= XX1)||(persangle ==0.5)){
            ctx2.lineWidth = 0.5;
            ctx2.beginPath();
            ctx2.setLineDash([5, 5]);
            ctx2.moveTo(lineX1end, lineY1);
            ctx2.lineTo(lineX1begin  , lineY1);
            ctx2.stroke();
            ctx2.setLineDash([]);
            ctx2.closePath();
            }
          if((lineX1end >=  XX1) && (lineY1<oldlineY1)){
            ctx2.lineWidth = 4;
            ctx2.beginPath();
            ctx2.moveTo(lineX1end, lineY1);
            ctx2.lineTo(lineX1begin  , lineY1);
            ctx2.stroke();
            ctx2.closePath();
            }
          if(((lineX1end >=  XX1)||(persangle ==0.5)) && (lineY1<=oldlineY1)){
            ctx2.lineWidth = 0.5;
            ctx2.beginPath();
            ctx2.setLineDash([5, 5]);
            ctx2.moveTo(lineX1end, lineY1);
            ctx2.lineTo(lineX1begin  , lineY1);
            ctx2.stroke();
            ctx2.setLineDash([]);
            ctx2.closePath();
            }
      }
  }
  tt = !tt;
  if (tt == true ){click1 = click1 +      ((width1/(height1+width1))*0.5)};
  if (tt == false){click1 = click1 + 0.5 -((width1/(height1+width1))*0.5)};
  ctx2.stroke();
  }

  if (incCounterbox1 == 800*compspeed/v1box){incCounterbox1 = 0};

  ctx4.strokeStyle = "green";
  ctx4.fillStyle = "green"
  ctx4.beginPath();
  ctx4.lineWidth = 4;
  ctx4.ellipse(XX1+(length1*0.5*(canvas1.width*0.05)), YY, 8*aspectconstant, 8, 0, 0, 2 * Math.PI);
  ctx4.stroke();
  ctx4.fill();
  ctx4.closePath();

  v1box = oldv1box;
  XX1 = oldXX1;
  }

//___________________Box 2_____________
  if (shape2 ==3) {
      if(collidenow == false){
          beforecollisionv1 = v1;
          beforecollisionv2 = v2;
      }
  width2 = outradius2;
  height2 = inradius2;
  boxradius2 = (Math.sqrt((width2*width2)+(height2*height2)));

  oldv2box = v2box;
  v2box = -v2box;

  click2 = -1;

  if((collidenow == true) && (XX2<=((canvas1.width*0.5)))){v2box = -v3box}

  var increment2 = v2box * 0.0025 * Math.PI/compspeed;
  turnIncrement2= incCounter2*increment2;

  while(click2 < 1){
      incCounter2=incCounter2 + 1;

      oldlineX2begin = lineX2begin;
      oldlineX2end   = lineX2end;
      oldlineY2      = lineY2;

      lineX2begin   = XX2                                      +(canvas1.width * 0.1 * Math.cos(persangle*Math.PI)*aspectconstant*boxradius2*(Math.cos((2*Math.PI*click2)+turnIncrement2)));
      lineX2end     = XX2  +(0.05 * length2 * canvas1.width)   +(canvas1.width * 0.1 * Math.cos(persangle*Math.PI)*aspectconstant*boxradius2*(Math.cos((2*Math.PI*click2)+turnIncrement2)));
      lineY2        = YY                                       +(canvas1.height* 0.1 *boxradius2*(Math.sin((2*Math.PI*click2)+turnIncrement2)));

// ______________avoiding writing a ton of arrays... ________________
      BAX5begin = BAX4begin;
      BAY5begin = BAY4begin;
      BAX5end   = BAX4end;
      BAY5end   = BAY4end;
//_________________
      BAX4begin = BAX3begin;
      BAY4begin = BAY3begin;
      BAX4end   = BAX3end;
      BAY4end   = BAY3end;
      //_________________
      BAX3begin = BAX2begin;
      BAY3begin = BAY2begin;
      BAX3end   = BAX2end;
      BAY3end   = BAY2end;
      //_________________
      BAX2begin = BAX1begin;
      BAY2begin = BAY1begin;
      BAX2end   = BAX1end;
      BAY2end   = BAY1end;
      //_________________
      BAX1begin = lineX2begin;
      BAY1begin = lineY2;
      BAX1end   = lineX2end;
      BAY1end   = lineY2;

//left box shading
      ctx3.lineWidth = 3;
      ctx3.fillStyle = color2;
      ctx3.beginPath();

      ctx3.moveTo(BAX1begin, BAY1begin);
      ctx3.lineTo(BAX1end,   BAY1end);
      ctx3.lineTo(BAX2end,   BAY2end);
      ctx3.lineTo(BAX2begin, BAY2begin);
      ctx3.lineTo(BAX1begin, BAY1begin);

      ctx3.lineTo(BAX1begin, BAY1begin);
      ctx3.lineTo(BAX2begin, BAY2begin);
      ctx3.lineTo(BAX3begin, BAY3begin);
      ctx3.lineTo(BAX4begin, BAY4begin);
      ctx3.lineTo(BAX1begin, BAY1begin);
      ctx3.closePath();

      ctx3.fill();

      ctx4.strokeStyle = "DarkBlue";

      if ((lineY2 <= oldlineY2)||(persangle ==0.5)){
              ctx4.lineWidth = 4;
              ctx4.beginPath();
              ctx4.moveTo(oldlineX2begin,oldlineY2);
              ctx4.lineTo(lineX2begin,lineY2);
              ctx4.stroke();
              ctx4.closePath();
          }

      ctx4.lineWidth = 4;
      ctx4.beginPath();
      ctx4.moveTo(oldlineX2end,oldlineY2);
      ctx4.lineTo(lineX2end,lineY2);
      ctx4.stroke();
      ctx4.closePath();
      if ((lineY2 >= oldlineY2)||(persangle ==0.5)){
              ctx4.lineWidth = 0.5;
              ctx4.beginPath();
              ctx4.setLineDash([5, 5]);
              ctx4.moveTo(oldlineX2begin, oldlineY2);
              ctx4.lineTo(lineX2begin, lineY2);
              ctx4.stroke();
              ctx4.setLineDash([]);
              ctx4.closePath();
          }
      if(v2box<=0){
          if (lineY2 > YY){
              if(((lineX2begin >=  XX2)||(persangle ==0.5)) && (lineY2<=oldlineY2)||(lineX2begin <= oldlineX2begin)){
                  ctx4.lineWidth = 4;
                  ctx4.beginPath();
                  ctx4.moveTo(lineX2end, lineY2);
                  ctx4.lineTo(lineX2begin, lineY2);
                  ctx4.stroke();
                  ctx4.closePath();
                  }
              if(((lineX2begin >=  XX2)||(persangle ==0.5)) && (lineY2>=oldlineY2)||(lineX2begin >= oldlineX2begin)){
                ctx4.lineWidth = 0.5;

                ctx4.beginPath();
                ctx4.setLineDash([5, 5]);
                ctx4.moveTo(lineX2end, lineY2);
                ctx4.lineTo(lineX2begin  , lineY2);
                ctx4.stroke();
                ctx4.setLineDash([]);
                ctx4.closePath();
                  }
              }
              if (lineY2 <= YY){
                  if((lineX2begin <= XX2)||(persangle ==0.5) ){
                    ctx4.lineWidth = 4;
                    ctx4.beginPath();
                    ctx4.moveTo(lineX2end, lineY2);
                    ctx4.lineTo(lineX2begin  , lineY2);
                    ctx4.stroke();
                    ctx4.closePath();
                    }
              if((lineX2begin >= XX2)||(persangle ==0.5) ){
                    ctx4.lineWidth = 0.5;

                    ctx4.beginPath();
                    ctx4.setLineDash([5, 5]);
                    ctx4.moveTo(lineX2end, lineY2);
                    ctx4.lineTo(lineX2begin  , lineY2);
                    ctx4.stroke();
                    ctx4.setLineDash([]);
                    ctx4.closePath();
                    }
              if(((lineX2begin >=  XX2)||(persangle ==0.5)) && (lineY2<=oldlineY2)){
                    ctx4.lineWidth = 4;
                    ctx4.beginPath();
                    ctx4.moveTo(lineX2end, lineY2);
                    ctx4.lineTo(lineX2begin  , lineY2);
                    ctx4.stroke();
                    ctx4.closePath();
                    }
              if(((lineX2begin >= XX2)||(persangle ==0.5)) && (lineY2>=oldlineY2)){
                    ctx4.lineWidth = 0.5;
                    ctx4.beginPath();
                    ctx4.setLineDash([5, 5]);
                    ctx4.moveTo(lineX2end, lineY2);
                    ctx4.lineTo(lineX2begin  , lineY2);
                    ctx4.stroke();
                    ctx4.setLineDash([]);
                    ctx4.closePath();
              }
        }
    }

    if(v2box>0){
        if (lineY2 >= YY){
            if((lineX2end <= XX2) && (lineY2<oldlineY2)&&(lineX2end >= oldlineX2end)){
                ctx4.lineWidth = 4;
                ctx4.beginPath();
                ctx4.moveTo(lineX2end, lineY2);
                ctx4.lineTo(lineX2begin  , lineY2);
                ctx4.stroke();
                }
            if((lineX2end <= XX2) && (lineY2>=oldlineY2)&&(lineX2end <= oldlineX2end)){
                ctx4.lineWidth = 0.5;
                ctx4.beginPath();
                ctx4.setLineDash([5, 5]);
                ctx4.moveTo(lineX2end, lineY2);
                ctx4.lineTo(lineX2begin  , lineY2);
                ctx4.stroke();
                ctx4.setLineDash([]);
                ctx4.closePath();
                }
            if((lineX2end >=  XX2) && (lineY2<=oldlineY2)||(lineX2end <= oldlineX2end)){
                ctx4.lineWidth = 4;
                ctx4.beginPath();
                ctx4.moveTo(lineX2end, lineY2);
                ctx4.lineTo(lineX2begin  , lineY2);
                ctx4.stroke();
                ctx4.closePath();
                }
            if((lineX2end >=  XX2) && (lineY2>=oldlineY2)||(lineX2end >= oldlineX2end)){
                ctx4.lineWidth = 0.5;
                ctx4.beginPath();
                ctx4.setLineDash([5, 5]);
                ctx4.moveTo(lineX2end, lineY2);
                ctx4.lineTo(lineX2begin  , lineY2);
                ctx4.stroke();
                ctx4.setLineDash([]);
                ctx4.closePath();
                }
            }

      if (lineY2 <= YY){
            if((lineX2end <= XX2)){
                ctx4.lineWidth = 4;
                ctx4.beginPath();
                ctx4.moveTo(lineX2end, lineY2);
                ctx4.lineTo(lineX2begin  , lineY2);
                ctx4.stroke();
                ctx4.closePath();
                }
            if((lineX2end >= XX2)){
                ctx4.lineWidth = 0.5;
                ctx4.beginPath();
                ctx4.setLineDash([5, 5]);
                ctx4.moveTo(lineX2end, lineY2);
                ctx4.lineTo(lineX2begin  , lineY2);
                ctx4.stroke();
                ctx4.setLineDash([]);
                ctx4.closePath();
                }
            if((lineX2end >=  XX2) && (lineY2<=oldlineY2)){
                ctx4.lineWidth = 4;
                ctx4.beginPath();
                ctx4.moveTo(lineX2end, lineY2);
                ctx4.lineTo(lineX2begin  , lineY2);
                ctx4.stroke();
                ctx4.closePath();
                }
            if((lineX2end >=  XX2) && (lineY2<=oldlineY2)){
                ctx4.lineWidth = 0.5;
                ctx4.beginPath();
                ctx4.setLineDash([5, 5]);
                ctx4.moveTo(lineX2end, lineY2);
                ctx4.lineTo(lineX2begin  , lineY2);
                ctx4.stroke();
                ctx4.setLineDash([]);
                ctx4.closePath();
                }
        }
    }

    tt = !tt;
    if (tt == true ){click2 = click2 +      ((width2/(height2+width2))*0.5)};
    if (tt == false){click2 = click2 + 0.5 -((width2/(height2+width2))*0.5)};
    ctx4.stroke();
    }

    if (incCounter2 == 800*compspeed/v2box){incCounter2 = 0};

    ctx4.strokeStyle = "green";
    ctx4.fillStyle = "green"
    ctx4.beginPath();
    ctx4.lineWidth = 4;
    ctx4.ellipse(XX2+(length2*0.5*(canvas1.width*0.05)), YY, 8*aspectconstant, 8, 0, 0, 2 * Math.PI);
    ctx4.stroke();
    ctx4.fill()
    ctx4.closePath();
    ctx4.strokeStyle = "darkBlue";

    v2box = oldv2box;
    XX2 = oldXX2;
  }

  if(collidenow == false){
    beforecollisionv1 = v1;
    beforecollisionv2 = v2;
  }

  if(shape1 ==1){angI1 =  0.5 * mass1 * ((outradius1 * outradius1) + (inradius1 * inradius1));}
  if(shape1 ==2){angI1 =  0.5 * mass1 * outradius1 * outradius1;}
  if(shape1 ==3){angI1 =  (1/12) * mass1 * ((4 * outradius1 * outradius1) + (4 * inradius1 * inradius1));}

  if(shape2 ==1){angI2 =  0.5 * mass2 * ((outradius2 * outradius2) + (inradius2 * inradius2));}
  if(shape2 ==2){angI2 =  0.5 * mass2 * outradius2 * outradius2;}
  if(shape2 ==3){angI2 =  (1/12) * mass2 * ((4 * outradius2 * outradius2) + (4 * inradius2 * inradius2));}

  angL1 = angI1*beforecollisionv1;
  angL2 = angI2*beforecollisionv2;

  totalL = (angI1*beforecollisionv1) + (angI2*beforecollisionv2);
  totalI = angI1 + angI2;

  v3 = totalL/totalI;

  angL1after = angI1*v3;
  angL2after = angI2*v3;

  v3box =v3*vconstant;

                              thecoordinatebutton = false;
                              ctx.fillStyle = "black";
                              ctx.font = " lighter 35px Arial";

                              if (thecoordinatebutton == true){
                                  ctx.fillText("AAX1begin = " + AAX1begin.toFixed(2) + " AAY1begin  = " + AAY1begin.toFixed(2),(0.01*canvas1.width),(0.3*canvas1.height),canvas1.width*0.28);
                                  ctx.fillText("AAX1end   = " + AAX1end.toFixed(2)   + " AAY1end    = " + AAY1end.toFixed(2)  ,(0.01*canvas1.width),(0.4*canvas1.height),canvas1.width*0.28);
                                  ctx.fillText("AAX2end   = " + AAX2end.toFixed(2)   + " AAY2end    = " + AAY2end.toFixed(2)  ,(0.01*canvas1.width),(0.5*canvas1.height),canvas1.width*0.28);
                                  ctx.fillText("AAX3end   = " + AAX3end.toFixed(2)   + " AAY3end    = " + AAY3end.toFixed(2)  ,(0.01*canvas1.width),(0.6*canvas1.height),canvas1.width*0.28);
                                  ctx.fillText("AAX3begin = " + AAX3begin.toFixed(2) + " AAY3begin  = " + AAY3begin.toFixed(2),(0.01*canvas1.width),(0.7*canvas1.height),canvas1.width*0.28);
                                  ctx.fillText("AAX4begin = " + AAX4begin.toFixed(2) + " AAY4begin  = " + AAY4begin.toFixed(2),(0.01*canvas1.width),(0.8*canvas1.height),canvas1.width*0.28);
                                  ctx.fillText("AAX1begin = " + AAX1begin.toFixed(2) + " AAY1begin  = " + AAY1begin.toFixed(2),(0.01*canvas1.width),(0.9*canvas1.height),canvas1.width*0.28);
                                }

  if (themathbutton == true){
      ctx.fillStyle = "black";
      ctx.font = " lighter 35px Arial";

      ctx.fillText("I : MOMENT OF  INERTIA" ,                                 (0.01*canvas1.width),(0.3*canvas1.height),canvas1.width*0.18);
      if (shape1 ==1){
            ctx.fillStyle = "Maroon";
            ctx.fillText("I₁ = ½ M₁(R₁² + r₁²)" ,                           (0.02*canvas1.width),(0.37*canvas1.height),canvas1.width*0.17);
            ctx.fillText("I₁ = ½ ("+(mass1.toFixed(2))+") (("+(outradius1)+"²)"+" + ("+(inradius1)+"²))" ,  (0.02*canvas1.width),(0.44*canvas1.height),canvas1.width*0.22);
            ctx.fillText("I₁ = "+(v3.toFixed(2))+" kg.m²",              (0.02*canvas1.width),(0.51*canvas1.height),canvas1.width*0.17);
            }
      if (shape1 ==2){
            ctx.fillStyle = "Maroon";
            ctx.fillText("I₁ = ½ M₁R₁²" ,                                  (0.02*canvas1.width),(0.37*canvas1.height),canvas1.width*0.20);
            ctx.fillText("I₁ = ½ ("+(mass1.toFixed(2))+") ("+(outradius1)+")²" , (0.02*canvas1.width),(0.44*canvas1.height),canvas1.width*0.15);
            ctx.fillText("I₁ = "+(angI1.toFixed(2))+" kg.m²     ",     (0.02*canvas1.width),(0.51*canvas1.height),canvas1.width*0.17);
            }
      if (shape1 ==3){
            ctx.fillStyle = "Maroon";
            ctx.fillText("I₁ = 1/12 M₁(H₁² + W₁²)" ,                        (0.02*canvas1.width),(0.37*canvas1.height),canvas1.width*0.17);
            ctx.fillText("I₁ = 1/12 ("+(mass1.toFixed(2))+") (("+(outradius1*2)+"²)"+" + ("+(inradius1*2)+"²))" ,  (0.02*canvas1.width),(0.44*canvas1.height),canvas1.width*0.22);
            ctx.fillText("I₁ = "+(angI1.toFixed(2))+" kg.m²" ,    (0.02*canvas1.width),(0.51*canvas1.height),canvas1.width*0.17);
          }

      ctx.fillStyle = "Black";
      ctx.fillText("L : ANGULAR  MOMENTUM" ,                                (0.01*canvas1.width),(0.65*canvas1.height),canvas1.width*0.22);
      ctx.fillStyle = "Maroon";
      ctx.fillText("L₁ = I₁ω₁" ,                                            (0.02*canvas1.width),(0.72*canvas1.height),canvas1.width*0.15);
  //    if(collidenow == false){
          ctx.fillText("L₁ = ("+(angI1.toFixed(2))+") ("+(beforecollisionv1)+")" ,   (0.02*canvas1.width),(0.79*canvas1.height),canvas1.width*0.13)
          ctx.fillText("L₁ = "+(angL1.toFixed(2))+" kg.m²/s" ,              (0.02*canvas1.width),(0.86*canvas1.height),canvas1.width*0.28);
    //    };
  //    if(collidenow == true ){
    //      ctx.fillText("L₁ = ("+(angI1.toFixed(2))+") ("+(v3.toFixed(2))+")" ,   (0.02*canvas1.width),(0.79*canvas1.height),canvas1.width*0.13)
    //      ctx.fillText("L₁ = "+(angL1after.toFixed(2))+" kg.m²/s" ,              (0.02*canvas1.width),(0.86*canvas1.height),canvas1.width*0.28)
    //    };

      ctx.fillStyle = "black";
      ctx.fillText("I : MOMENT OF  INERTIA" ,                               (0.74*canvas1.width),(0.3*canvas1.height),canvas1.width*0.18);
      if (shape2 ==1){
            ctx.fillStyle = "Blue";
            ctx.fillText("I₂ = ½ M₂(R₂² + r₂²)" ,                           (0.75*canvas1.width),(0.37*canvas1.height),canvas1.width*0.17);
            ctx.fillText("I₂ = ½ ("+(mass2.toFixed(2))+") (("+(outradius2)+"²)"+" + ("+(inradius2)+"²))" ,  (0.75*canvas1.width),(0.44*canvas1.height),canvas1.width*0.22);
            ctx.fillText("I₂ = "+(angI2.toFixed(2))+" kg.m²",           (0.75*canvas1.width),(0.51*canvas1.height),canvas1.width*0.17);
            }
      if (shape2 ==2){
            ctx.fillStyle = "Blue";
            ctx.fillText("I₂ = ½ M₂R₂²" ,                                   (0.75*canvas1.width),(0.37*canvas1.height),canvas1.width*0.20);
            ctx.fillText("I₂ = ½ ("+(mass2.toFixed(2))+") ("+(outradius2)+")²",  (0.75*canvas1.width),(0.44*canvas1.height),canvas1.width*0.15);
            ctx.fillText("I₂ = "+(angI2.toFixed(2))+" kg.m²     ",      (0.75*canvas1.width),(0.51*canvas1.height),canvas1.width*0.17);
            }
      if (shape2 ==3){
            ctx.fillStyle = "Blue";
            ctx.fillText("I₂ = 1/12 M₂(H₂² + W₂²)" ,                        (0.75*canvas1.width),(0.37*canvas1.height),canvas1.width*0.17);
            ctx.fillText("I₂ = 1/12 ("+(mass2.toFixed(2))+") (("+(outradius2*2)+"²)"+" + ("+(inradius2*2)+"²))" ,  (0.75*canvas1.width),(0.44*canvas1.height),canvas1.width*0.22);
            ctx.fillText("I₂ = "+(angI2.toFixed(2))+" kg.m²" ,          (0.75*canvas1.width),(0.51*canvas1.height),canvas1.width*0.17);
          }

      ctx.fillStyle = "Black";
      ctx.fillText("L : ANGULAR MOMENTUM" ,                                 (0.74*canvas1.width),(0.65*canvas1.height),canvas1.width*0.22);
      ctx.fillStyle = "Blue";
      ctx.fillText("L₂ = I₂ω₂" ,                                            (0.75*canvas1.width),(0.72*canvas1.height),canvas1.width*0.15);
  //    if(collidenow == false){
            ctx.fillText("L₂ = ("+(angI2.toFixed(2))+") ("+(beforecollisionv2)+")" ,  (0.75*canvas1.width),(0.79*canvas1.height),canvas1.width*0.13);
            ctx.fillText("L₂ = "+(angL2.toFixed(2))+" kg.m²/s" ,              (0.75*canvas1.width),(0.86*canvas1.height),canvas1.width*0.28);
        //  };
    //  if(collidenow == true ){
    //        ctx.fillText("L₂ = ("+(angI2.toFixed(2))+") ("+(v3.toFixed(2))+")" ,  (0.75*canvas1.width),(0.79*canvas1.height),canvas1.width*0.13)
          //  ctx.fillText("L₂ = "+(angL2after.toFixed(2))+" kg.m²/s" ,              (0.75*canvas1.width),(0.86*canvas1.height),canvas1.width*0.28);
      //    };


      ctx.fillStyle = "black";
      ctx.fillText("Total L of an islated sytem is constant." ,             (0.34*canvas1.width),(0.58*canvas1.height),canvas1.width*0.3);
      ctx.fillText("Total L before event = Total L after event" ,           (0.368*canvas1.width),(0.64*canvas1.height),canvas1.width*0.25);

      if((collidenow == true) && (XX2 <= canvas1.width*0.5)){
          ctx.fillStyle = "DarkGreen";
          ctx.fillText("I₁ω₁ + I₂ω₂ = I₁ω₃ + I₂ω₃" ,                    (0.423*canvas1.width),(0.69*canvas1.height),canvas1.width*0.15);
          ctx.fillText((angL1.toFixed(2))+" + "+(angL2.toFixed(2))+" = "+(angI1.toFixed(2))+"ω₃ + "+(angI2.toFixed(2))+"ω₃" ,  (0.41*canvas1.width),(0.76*canvas1.height),canvas1.width*0.2);
          ctx.fillText(""+(totalL.toFixed(2))+" = "+(totalI.toFixed(2))+"ω₃" ,    (0.466*canvas1.width),(0.83*canvas1.height),canvas1.width*0.08);
          ctx.fillText("ω₃ = "+(totalL.toFixed(2))+" / "+(totalI.toFixed(2)) ,    (0.478*canvas1.width),(0.90*canvas1.height),canvas1.width*0.09);
          ctx.fillText("ω₃ = "+(v3.toFixed(2))+" radians/second" ,                    (0.472*canvas1.width ),(0.97*canvas1.height),canvas1.width*0.18);
          ctx.fillstyle = "Black";
      }
  }

//testxvalue=true;
  if (testxvalue == true){
      ctx.font = "lighter 20px Arial";
      ctx.beginPath();
      ctx.strokeStyle = "black";

      ctx.fillText("velocity 1 = " + v1,0.1*canvas1.width,50);
      ctx.fillText("mass 1 = " + mass1.toFixed(2),0.1*canvas1.width,100);
      ctx.fillText("density 1  = "+ density1.toFixed(2),0.1*canvas1.width,150);
      ctx.fillText("length 1 = "+ length1,0.1*canvas1.width,200);
      ctx.fillText("outer radius 1 = "+ outradius1,0.1*canvas1.width,250);
      ctx.fillText("inner radius 1 = "+ inradius1,0.1*canvas1.width,300);
      ctx.fillText("width 1 = "+ width1,0.1*canvas1.width,350);
      ctx.fillText("height 1 = " + height1,0.1*canvas1.width,400);
      ctx.fillText("volume 1 = " + volume1.toFixed(2),0.1*canvas1.width,450);
      ctx.fillText("shape 1 = " + shape1,0.1*canvas1.width,500);
      ctx.fillText("v1box = " + v1box,0.1*canvas1.width,550);

      ctx.fillText("velocity 2 = " + v2,0.8*canvas1.width,50);
      ctx.fillText("mass 2 = " + mass2.toFixed(2),0.8*canvas1.width,100);
      ctx.fillText("density 2 = " + density2.toFixed(2),0.8*canvas1.width,150);
      ctx.fillText("length 2 = " + length2,0.8*canvas1.width,200);
      ctx.fillText("outer radius 2 = " + outradius2,0.8*canvas1.width,250);
      ctx.fillText("inner radius 2 = " + inradius2,0.8*canvas1.width,300);
      ctx.fillText("width 2 = " + width2,0.8*canvas1.width,350);
      ctx.fillText("height 2 =" + height2,0.8*canvas1.width,400);
      ctx.fillText("volume 2 = " + volume2.toFixed(2),0.8*canvas1.width,450);
      ctx.fillText("shape 2 = " + shape2,0.8*canvas1.width,500);
      ctx.fillText("v2box = " + v1box,0.8*canvas1.width,550);
      ctx.fillText("boxradius2 = " + boxradius2.toFixed(4),0.8*canvas1.width,600);
      ctx.fillText("persangle = " + persangle.toFixed(4),0.8*canvas1.width,650);

      ctx.stroke();
      ctx.fill();
      ctx.closePath();
   }
//____________________________________________________________________

requestAnimationFrame(draw);
}

</script>
</html>
